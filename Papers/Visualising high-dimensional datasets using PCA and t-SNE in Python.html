<!DOCTYPE html>
<!-- saved from url=(0108)https://medium.com/@luckylwk/visualising-high-dimensional-datasets-using-pca-and-t-sne-in-python-8ef87e7915b -->
<html xmlns:cc="http://creativecommons.org/ns#"><head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# medium-com: http://ogp.me/ns/fb/medium-com#"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Visualising high-dimensional datasets using PCA and t-SNE in Python</title><link rel="canonical" href="https://medium.com/@luckylwk/visualising-high-dimensional-datasets-using-pca-and-t-sne-in-python-8ef87e7915b"><meta name="title" content="Visualising high-dimensional datasets using PCA and t-SNE in Python"><meta name="referrer" content="always"><meta name="description" content="The first step around any data related challenge is to start by exploring the data itself. This could be by looking at, for example, the distributions of certain variables or looking at potential…"><meta name="theme-color" content="#000000"><meta property="og:title" content="Visualising high-dimensional datasets using PCA and t-SNE in Python"><meta property="og:url" content="https://medium.com/@luckylwk/visualising-high-dimensional-datasets-using-pca-and-t-sne-in-python-8ef87e7915b"><meta property="og:image" content="https://cdn-images-1.medium.com/max/1200/1*aA35Y_xIyqNyeSYqIAifQQ.png"><meta property="fb:app_id" content="542599432471018"><meta property="og:description" content="The first step around any data related challenge is to start by exploring the data itself. This could be by looking at, for example, the…"><meta name="twitter:description" content="The first step around any data related challenge is to start by exploring the data itself. This could be by looking at, for example, the…"><meta name="twitter:image:src" content="https://cdn-images-1.medium.com/max/1200/1*aA35Y_xIyqNyeSYqIAifQQ.png"><link rel="publisher" href="https://plus.google.com/103654360130207659246"><link rel="author" href="https://medium.com/@luckylwk"><meta property="author" content="Luuk Derksen"><meta property="og:type" content="article"><meta name="twitter:card" content="summary_large_image"><meta property="article:publisher" content="https://www.facebook.com/medium"><meta property="article:author" content="Luuk Derksen"><meta name="robots" content="index, follow"><meta property="article:published_time" content="2016-10-29T12:11:20.007Z"><meta name="twitter:creator" content="@luckylwk"><meta name="twitter:site" content="@Medium"><meta property="og:site_name" content="Medium"><meta name="twitter:label1" value="Reading time"><meta name="twitter:data1" value="9 min read"><meta name="twitter:app:name:iphone" content="Medium"><meta name="twitter:app:id:iphone" content="828256236"><meta name="twitter:app:url:iphone" content="medium://p/8ef87e7915b"><meta property="al:ios:app_name" content="Medium"><meta property="al:ios:app_store_id" content="828256236"><meta property="al:android:package" content="com.medium.reader"><meta property="al:android:app_name" content="Medium"><meta property="al:ios:url" content="medium://p/8ef87e7915b"><meta property="al:android:url" content="medium://p/8ef87e7915b"><meta property="al:web:url" content="https://medium.com/@luckylwk/visualising-high-dimensional-datasets-using-pca-and-t-sne-in-python-8ef87e7915b"><link rel="search" type="application/opensearchdescription+xml" title="Medium" href="https://medium.com/osd.xml"><link rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/8ef87e7915b"><script type="application/ld+json">{"@context":"http://schema.org","@type":"NewsArticle","image":{"@type":"ImageObject","width":1868,"height":788,"url":"https://cdn-images-1.medium.com/max/1868/1*aA35Y_xIyqNyeSYqIAifQQ.png"},"datePublished":"2016-10-29T12:11:20.007Z","dateModified":"2017-05-31T12:53:59.506Z","headline":"Visualising high-dimensional datasets using PCA and t-SNE in Python","name":"Visualising high-dimensional datasets using PCA and t-SNE in Python","keywords":["Data Science","Machine Learning","Data Visualization"],"author":{"@type":"Person","name":"Luuk Derksen","url":"https://medium.com/@luckylwk"},"creator":["Luuk Derksen"],"publisher":{"@type":"Organization","name":"Medium","url":"https://medium.com/","logo":{"@type":"ImageObject","width":215,"height":60,"url":"https://cdn-images-1.medium.com/max/215/1*5ztbgEt4NqpVaxTc64C-XA.png"}},"mainEntityOfPage":"https://medium.com/@luckylwk/visualising-high-dimensional-datasets-using-pca-and-t-sne-in-python-8ef87e7915b"}</script><link rel="stylesheet" type="text/css" href="./Visualising high-dimensional datasets using PCA and t-SNE in Python_files/fonts-lazy-latin-base.jMU532QDmysQMOINr-cr2A.css"><link rel="stylesheet" href="./Visualising high-dimensional datasets using PCA and t-SNE in Python_files/main-base.1Vic6IHBSMCypAERCfbqsQ.css"><script>if (window.top !== window.self) window.top.location = window.self.location.href;var OB_startTime = new Date().getTime(); var OB_loadErrors = []; function _onerror(e) { OB_loadErrors.push(e) }; if (document.addEventListener) document.addEventListener("error", _onerror, true); else if (document.attachEvent) document.attachEvent("onerror", _onerror); function _asyncScript(u) {var d = document, f = d.getElementsByTagName("script")[0], s = d.createElement("script"); s.type = "text/javascript"; s.async = true; s.src = u; f.parentNode.insertBefore(s, f);}function _asyncStyles(u) {var d = document, f = d.getElementsByTagName("script")[0], s = d.createElement("link"); s.rel = "stylesheet"; s.href = u; f.parentNode.insertBefore(s, f); return s}(new Image()).src = "/_/stat?event=pixel.load&origin=" + encodeURIComponent(location.origin);</script><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date; ga("create", "UA-24232453-2", "auto", {"allowLinker": true, "legacyCookieDomain": window.location.hostname}); ga("send", "pageview");</script><script async="" src="./Visualising high-dimensional datasets using PCA and t-SNE in Python_files/analytics.js"></script><!--[if lt IE 9]><script charset="UTF-8" src="https://cdn-static-1.medium.com/_/fp/js/shiv.RI2ePTZ5gFmMgLzG5bEVAA.js"></script><![endif]--><link rel="icon" href="https://cdn-static-1.medium.com/_/fp/icons/favicon-medium.TAS6uQ-Y7kcKgi0xjcYHXw.ico" class="js-favicon"><link rel="apple-touch-icon" sizes="152x152" href="https://cdn-images-1.medium.com/fit/c/152/152/1*W0nmth_X8nFKjn6BZ388UQ.png"><link rel="apple-touch-icon" sizes="120x120" href="https://cdn-images-1.medium.com/fit/c/120/120/1*W0nmth_X8nFKjn6BZ388UQ.png"><link rel="apple-touch-icon" sizes="76x76" href="https://cdn-images-1.medium.com/fit/c/76/76/1*W0nmth_X8nFKjn6BZ388UQ.png"><link rel="apple-touch-icon" sizes="60x60" href="https://cdn-images-1.medium.com/fit/c/60/60/1*W0nmth_X8nFKjn6BZ388UQ.png"><link rel="mask-icon" href="https://cdn-static-1.medium.com/_/fp/icons/favicon.KjTfUJo7yJH_fCoUzzH3cg.svg" color="#171717"></head><body itemscope="" class="postShowScreen browser-chrome is-withMagicUnderlines is-js" data-action-scope="_actionscope_0"><script>document.body.className = document.body.className.replace(/(^|\s)is-noJs(\s|$)/, "$1is-js$2")</script><div class="site-main surface-container" id="container"><div class="butterBar butterBar--error" data-action-scope="_actionscope_1"></div><div class="surface" id="_obv.shell._surface_1496324714661" style="display: block; visibility: visible;"><div class="screenContent surface-content is-supplementalPostContentLoaded" data-used="true" data-action-scope="_actionscope_2"><canvas class="canvas-renderer" width="1840" height="941"></canvas><div class="container u-maxWidth740 u-xs-margin0 notesPositionContainer js-notesPositionContainer"><div class="notesMarkers" data-action-scope="_actionscope_4"></div></div><div class="metabar u-clearfix js-metabar is-hiddenWhenMinimized metabar--affixed is-minimized"><div class="metabar-inner u-marginAuto u-maxWidth1000 u-paddingLeft20 u-paddingRight20 js-metabarMiddle"><div class="metabar-block metabar-block--left u-floatLeft u-height65 u-xs-height56"><a href="https://medium.com/" class="siteNav-logo" data-log-event="home"><span class="svgIcon svgIcon--logoNew svgIcon--45px is-flushLeft"><svg class="svgIcon-use" width="45" height="45" viewBox="-17 18 45 45" data-multipart="true"><path d="M11.525 28.078c-.472-.225-.858.002-.858.506v20.044l8.616 4.113c.948.46 1.717.14 1.717-.7v-19.3a.22.22 0 0 0-.124-.19l-9.35-4.46v-.01z"></path><path d="M.333 43.696l9.83-15.247c.278-.43.89-.6 1.36-.38l9.364 4.47c.06.03.082.1.047.15L10.666 48.63.333 43.698v-.002z"></path><path d="M-8.57 28.35c-.786-.375-1.053-.096-.592.62L.333 43.696l10.333 4.932L.356 32.635a.156.156 0 0 0-.06-.054l-8.866-4.23z"></path><path d="M.333 52.033c0 .84-.643 1.22-1.43.844l-8.045-3.84c-.472-.224-.858-.82-.858-1.325V28.89c0-.672.515-.976 1.145-.675l9.133 4.36a.092.092 0 0 1 .055.084v19.37z"></path></svg></span><span class="u-textScreenReader">Homepage</span></a></div><div class="metabar-block u-floatRight u-xs-absolute u-xs-textAlignRight u-xs-right0 u-xs-marginRight20 u-height65 u-xs-height56"><div class="buttonSet"><a class="button button--primary button--chromeless u-accentColor--buttonNormal is-inSiteNavBar u-lineHeight30 u-height32" href="https://medium.com/m/signin?redirect=https%3A%2F%2Fmedium.com%2F%40luckylwk%2Fvisualising-high-dimensional-datasets-using-pca-and-t-sne-in-python-8ef87e7915b" data-action="sign-in-prompt" data-redirect="https://medium.com/@luckylwk/visualising-high-dimensional-datasets-using-pca-and-t-sne-in-python-8ef87e7915b" data-action-source="nav_signup">Sign in / Sign up</a></div></div></div></div><div class="metabar metabar--spacer js-metabarSpacer u-height65 u-xs-height56"></div><main role="main"><article class=" u-sizeViewHeightMin100 u-overflowHidden postArticle postArticle--full u-marginBottom40" lang="en" data-scroll="native"><header class="container u-maxWidth740"><div class="postMetaHeader u-paddingBottom10 row"><div class="col u-size12of12 js-postMetaLockup"><div class="postMetaLockup postMetaLockup--authorWithBio u-flex js-postMetaLockup"><div class="u-flex0"><a class="link avatar u-baseColor--link" href="https://medium.com/@luckylwk?source=post_header_lockup" data-action="show-user-card" data-action-source="post_header_lockup" data-action-value="c85c6404c0f9" data-action-type="hover" data-user-id="c85c6404c0f9" dir="auto"><img src="./Visualising high-dimensional datasets using PCA and t-SNE in Python_files/0-E-t7oTrRvLnQ3qky.jpeg" class="avatar-image avatar-image--small" alt="Go to the profile of Luuk Derksen"></a></div><div class="u-flex1 u-paddingLeft15 u-overflowHidden"><a class="link link link--darken link--darker u-baseColor--link" href="https://medium.com/@luckylwk?source=post_header_lockup" data-action="show-user-card" data-action-source="post_header_lockup" data-action-value="c85c6404c0f9" data-action-type="hover" data-user-id="c85c6404c0f9" dir="auto">Luuk Derksen</a><span class="followState js-followState buttonSet-inner" data-user-id="c85c6404c0f9"><button class="button u-paddingLeft10 u-paddingRight10 u-height19 u-lineHeight13 u-verticalAlignMiddle u-fontSize12 u-uiTextMedium u-noUserSelect button--withChrome u-baseColor--buttonNormal button--withHover button--unblock js-unblockButton u-marginLeft10 u-marginTopNegative2 u-xs-hide" data-action="sign-in-prompt" data-sign-in-action="toggle-block-user" data-requires-token="true" data-action-source="post_header_lockup"><span class="button-label  button-defaultState">Blocked</span><span class="button-label button-hoverState">Unblock</span></button><button class="button button--primary u-paddingLeft10 u-paddingRight10 u-height19 u-lineHeight13 u-verticalAlignMiddle u-fontSize12 u-uiTextMedium u-noUserSelect button--withChrome u-accentColor--buttonNormal button--follow js-followButton u-marginLeft10 u-marginTopNegative2 u-xs-hide" data-action="sign-in-prompt" data-sign-in-action="toggle-subscribe-user" data-requires-token="true" data-redirect="https://medium.com/_/subscribe/user/c85c6404c0f9" data-action-source="post_header_lockup_follow"><span class="button-label  button-defaultState js-buttonLabel">Follow</span><span class="button-label button-activeState">Following</span></button></span><div class="postMetaInline u-noWrapWithEllipsis u-xs-normalWrap u-xs-lineClamp2 u-xs-maxHeight2LineHeightBase">Data (Scientist) junky. All views my own. | PGP: http://goo.gl/CMdQR7</div><div class="postMetaInline js-testPostMetaInlineSupplemental"><time datetime="2016-10-29T12:11:20.007Z">Oct 29, 2016</time><span class="middotDivider u-fontSize12"></span><span class="readingTime" title="9 min read"></span></div></div></div></div></div></header><div class="postArticle-content js-postField js-notesSource js-trackedPost" data-post-id="8ef87e7915b" data-source="post_page" data-tracking-context="postPage" data-scroll="native"><section name="7673" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h1 name="978f" id="978f" class="graf graf--h3 graf--leading graf--title">Visualising high-dimensional datasets using PCA and t-SNE in&nbsp;Python</h1><p name="6a62" id="6a62" class="graf graf--p graf-after--h3">The first step around any data related challenge is to start by exploring the data itself. This could be by looking at, for example, the distributions of certain variables or looking at potential correlations between variables.</p><p name="1414" id="1414" class="graf graf--p graf-after--p">The problem nowadays is that most datasets have a large number of variables. In other words, they have a high number of dimensions along which the data is distributed. Visually exploring the data can then become challenging and most of the time even practically impossible to do manually. However, such visual exploration is incredibly important in any data-related problem. Therefore it is key to understand how to visualise high-dimensional datasets. This can be achieved using techniques known as dimensionality reduction. This post will focus on two techniques that will allow us to do this: PCA and t-SNE.</p><p name="a55e" id="a55e" class="graf graf--p graf-after--p">More about that later. Lets first get some (high-dimensional) data to work with.</p><h3 name="f858" id="f858" class="graf graf--h3 graf-after--p">MNIST dataset</h3><p name="2837" id="2837" class="graf graf--p graf-after--h3">We will use the <a href="http://yann.lecun.com/exdb/mnist/" data-href="http://yann.lecun.com/exdb/mnist/" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">MNIST-dataset</a> in this write-up. There is no need to download the dataset manually as we can grab it through using <a href="http://scikit-learn.org/" data-href="http://scikit-learn.org/" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">Scikit Learn</a>.</p><pre name="3fee" id="3fee" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0"><strong class="markup--strong markup--pre-strong">import</strong> numpy <strong class="markup--strong markup--pre-strong">as</strong> np<br><strong class="markup--strong markup--pre-strong">from</strong> sklearn.datasets <strong class="markup--strong markup--pre-strong">import</strong> fetch_mldata</code></pre><pre name="a9b4" id="a9b4" class="graf graf--pre graf-after--pre"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0"><br>mnist <strong class="markup--strong markup--pre-strong">=</strong> fetch_mldata("MNIST original")<br>X <strong class="markup--strong markup--pre-strong">=</strong> mnist<strong class="markup--strong markup--pre-strong">.</strong>data <strong class="markup--strong markup--pre-strong">/</strong> 255.0<br>y <strong class="markup--strong markup--pre-strong">=</strong> mnist<strong class="markup--strong markup--pre-strong">.</strong>target<br><br></code></pre><pre name="6f98" id="6f98" class="graf graf--pre graf-after--pre"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0"><strong class="markup--strong markup--pre-strong">print</strong> X<strong class="markup--strong markup--pre-strong">.</strong>shape, y<strong class="markup--strong markup--pre-strong">.</strong>shape</code></pre><pre name="54a1" id="54a1" class="graf graf--pre graf-after--pre"><br>[out] (70000, 784) (70000,)</pre><p name="c3bf" id="c3bf" class="graf graf--p graf-after--pre">We are going to convert the matrix and vector to a Pandas DataFrame. This is very similar to the DataFrames used in R and will make it easier for us to plot it later on.</p><pre name="aebb" id="aebb" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0"><strong class="markup--strong markup--pre-strong">import</strong> pandas <strong class="markup--strong markup--pre-strong">as</strong> pd</code></pre><pre name="2ddc" id="2ddc" class="graf graf--pre graf-after--pre"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0"><br>feat_cols <strong class="markup--strong markup--pre-strong">=</strong> [ 'pixel'<strong class="markup--strong markup--pre-strong">+</strong>str(i) <strong class="markup--strong markup--pre-strong">for</strong> i <strong class="markup--strong markup--pre-strong">in</strong> range(X<strong class="markup--strong markup--pre-strong">.</strong>shape[1]) ]<br><br>df <strong class="markup--strong markup--pre-strong">=</strong> pd<strong class="markup--strong markup--pre-strong">.</strong>DataFrame(X,columns<strong class="markup--strong markup--pre-strong">=</strong>feat_cols)<br>df['label'] <strong class="markup--strong markup--pre-strong">=</strong> y<br>df['label'] <strong class="markup--strong markup--pre-strong">=</strong> df['label']<strong class="markup--strong markup--pre-strong">.</strong>apply(<strong class="markup--strong markup--pre-strong">lambda</strong> i: str(i))<br><br>X, y <strong class="markup--strong markup--pre-strong">=</strong> None, None</code></pre><pre name="9e21" id="9e21" class="graf graf--pre graf-after--pre"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0"><br><strong class="markup--strong markup--pre-strong">print</strong> 'Size of the dataframe: {}'<strong class="markup--strong markup--pre-strong">.</strong>format(df<strong class="markup--strong markup--pre-strong">.</strong>shape)</code></pre><pre name="d8e5" id="d8e5" class="graf graf--pre graf-after--pre"><br>[out] Size of the dataframe: (70000, 785)</pre><p name="07a5" id="07a5" class="graf graf--p graf-after--pre">Because we dont want to be using 70,000 digits in some calculations we’ll take a random subset of the digits. The randomisation is important as the dataset is sorted by its label (i.e., the first seven thousand or so are zeros, etc.). To ensure randomisation we’ll create a random permutation of the number 0 to 69,999 which allows us later to select the first five or ten thousand for our calculations and visualisations.</p><pre name="ac34" id="ac34" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">rndperm <strong class="markup--strong markup--pre-strong">=</strong> np<strong class="markup--strong markup--pre-strong">.</strong>random<strong class="markup--strong markup--pre-strong">.</strong>permutation(df<strong class="markup--strong markup--pre-strong">.</strong>shape[0])</code></pre><p name="b155" id="b155" class="graf graf--p graf-after--pre">We now have our dataframe and our randomisation vector. Lets first check what these numbers actually look like. To do this we’ll generate 30 plots of randomly selected images.</p><pre name="999c" id="999c" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0"><strong class="markup--strong markup--pre-strong">%</strong>matplotlib inline<br><strong class="markup--strong markup--pre-strong">import</strong> matplotlib.pyplot <strong class="markup--strong markup--pre-strong">as</strong> plt</code></pre><pre name="12ea" id="12ea" class="graf graf--pre graf-after--pre"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0"><br><em class="markup--em markup--pre-em"># Plot the graph</em><br>plt<strong class="markup--strong markup--pre-strong">.</strong>gray()<br>fig <strong class="markup--strong markup--pre-strong">=</strong> plt<strong class="markup--strong markup--pre-strong">.</strong>figure( figsize<strong class="markup--strong markup--pre-strong">=</strong>(16,7) )<br><strong class="markup--strong markup--pre-strong">for</strong> i <strong class="markup--strong markup--pre-strong">in</strong> range(0,30):<br>    ax <strong class="markup--strong markup--pre-strong">=</strong> fig<strong class="markup--strong markup--pre-strong">.</strong>add_subplot(3,10,i<strong class="markup--strong markup--pre-strong">+</strong>1, title<strong class="markup--strong markup--pre-strong">=</strong>'Digit: ' <strong class="markup--strong markup--pre-strong">+</strong> str(df<strong class="markup--strong markup--pre-strong">.</strong>loc[rndperm[i],'label']) )<br>    ax<strong class="markup--strong markup--pre-strong">.</strong>matshow(df<strong class="markup--strong markup--pre-strong">.</strong>loc[rndperm[i],feat_cols]<strong class="markup--strong markup--pre-strong">.</strong>values<strong class="markup--strong markup--pre-strong">.</strong>reshape((28,28))<strong class="markup--strong markup--pre-strong">.</strong>astype(float))</code></pre><pre name="b535" id="b535" class="graf graf--pre graf-after--pre"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">plt<strong class="markup--strong markup--pre-strong">.</strong>show()</code></pre><figure name="2f08" id="2f08" class="graf graf--figure graf-after--pre"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 295px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 42.199999999999996%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*aA35Y_xIyqNyeSYqIAifQQ.png" data-width="1868" data-height="788" data-action="zoom" data-action-value="1*aA35Y_xIyqNyeSYqIAifQQ.png" data-scroll="native"><img src="./Visualising high-dimensional datasets using PCA and t-SNE in Python_files/1-aA35Y_xIyqNyeSYqIAifQQ.png" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="30"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*aA35Y_xIyqNyeSYqIAifQQ.png" src="./Visualising high-dimensional datasets using PCA and t-SNE in Python_files/1-aA35Y_xIyqNyeSYqIAifQQ(1).png"><noscript class="js-progressiveMedia-inner">&lt;img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/800/1*aA35Y_xIyqNyeSYqIAifQQ.png"&gt;</noscript></div></div></figure><p name="a173" id="a173" class="graf graf--p graf-after--figure">Now we can start thinking about how we can actually distinguish the zeros from the ones and two’s and so on. If you were, for example, a post office such an algorithm could help you read and sort the handwritten envelopes using a machine instead of having humans do that. Obviously nowadays we have very advanced methods to do this, but this dataset still provides a very good testing ground for seeing how specific methods for dimensionality reduction work and how well they work.</p><p name="c86c" id="c86c" class="graf graf--p graf-after--p">The images are all essentially 28-by-28 pixel images and therefore have a total of 784 ‘dimensions’, each holding the value of one specific pixel.</p><p name="ed6e" id="ed6e" class="graf graf--p graf-after--p">What we can do is reduce the number of dimensions drastically whilst trying to retain as much of the ‘variation’ in the information as possible. This is where we get to dimensionality reduction. Lets first take a look at something known as <strong class="markup--strong markup--p-strong">Principal Component Analysis</strong>.</p><h3 name="49fa" id="49fa" class="graf graf--h3 graf-after--p">Dimensionality reduction using&nbsp;PCA</h3><p name="8b31" id="8b31" class="graf graf--p graf-after--h3">PCA is a technique for reducing the number of dimensions in a dataset whilst retaining most information. It is using the correlation between some dimensions and tries to provide a minimum number of variables that keeps the maximum amount of variation or information about how the original data is distributed. It does not do this using guesswork but using hard mathematics and it uses something known as the eigenvalues and eigenvectors of the data-matrix. These eigenvectors of the covariance matrix have the property that they point along the major directions of variation in the data. These are the directions of maximum variation in a dataset.</p><p name="604a" id="604a" class="graf graf--p graf-after--p">I am not going to get into the actual derivation and calculation of the principal components — if you want to get into the mathematics see <a href="https://www.math.hmc.edu/calculus/tutorials/eigenstuff/" data-href="https://www.math.hmc.edu/calculus/tutorials/eigenstuff/" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">this</a> great page — instead we’ll use the <a href="http://scikit-learn.org/stable/modules/generated/sklearn.decomposition.PCA.html" data-href="http://scikit-learn.org/stable/modules/generated/sklearn.decomposition.PCA.html" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">Scikit-Learn implementation of PCA</a>.</p><p name="9ae8" id="9ae8" class="graf graf--p graf-after--p">Since we as humans like our two- and three-dimensional plots lets start with that and generate, from the original 784 dimensions, the first three principal components. And we’ll also see how much of the variation in the total dataset they actually account for.</p><pre name="1e2c" id="1e2c" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0"><strong class="markup--strong markup--pre-strong">from</strong> sklearn.decomposition <strong class="markup--strong markup--pre-strong">import</strong> PCA</code></pre><pre name="4cf5" id="4cf5" class="graf graf--pre graf-after--pre"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0"><br>pca <strong class="markup--strong markup--pre-strong">=</strong> PCA(n_components<strong class="markup--strong markup--pre-strong">=</strong>3)<br>pca_result <strong class="markup--strong markup--pre-strong">=</strong> pca<strong class="markup--strong markup--pre-strong">.</strong>fit_transform(df[feat_cols]<strong class="markup--strong markup--pre-strong">.</strong>values)<br><br>df['pca-one'] <strong class="markup--strong markup--pre-strong">=</strong> pca_result[:,0]<br>df['pca-two'] <strong class="markup--strong markup--pre-strong">=</strong> pca_result[:,1] <br>df['pca-three'] <strong class="markup--strong markup--pre-strong">=</strong> pca_result[:,2]</code></pre><pre name="61ce" id="61ce" class="graf graf--pre graf-after--pre"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0"><br><strong class="markup--strong markup--pre-strong">print</strong> 'Explained variation per principal component: {}'<strong class="markup--strong markup--pre-strong">.</strong>format(pca<strong class="markup--strong markup--pre-strong">.</strong>explained_variance_ratio_)</code></pre><pre name="afd7" id="afd7" class="graf graf--pre graf-after--pre">[out] Explained variation per principal component: [ 0.16756229  0.0826886   0.05374424]</pre><p name="282f" id="282f" class="graf graf--p graf-after--pre">Now, given that the first two components account for about 25% of the variation in the entire dataset lets see if that is enough to visually set the different digits apart. What we can do is create a scatterplot of the first and second principal component and color each of the different types of digits with a different color. If we are lucky the same type of digits will be positioned (i.e., clustered) together in groups, which would mean that the first two principal components actually tell us a great deal about the specific types of digits.</p><pre name="d46c" id="d46c" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0"><strong class="markup--strong markup--pre-strong">from</strong> ggplot <strong class="markup--strong markup--pre-strong">import</strong> <strong class="markup--strong markup--pre-strong">*</strong></code></pre><pre name="a823" id="a823" class="graf graf--pre graf-after--pre"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0"><br>chart <strong class="markup--strong markup--pre-strong">=</strong> ggplot( df<strong class="markup--strong markup--pre-strong">.</strong>loc[rndperm[:3000],:], aes(x<strong class="markup--strong markup--pre-strong">=</strong>'x-pca', y<strong class="markup--strong markup--pre-strong">=</strong>'y-pca', color<strong class="markup--strong markup--pre-strong">=</strong>'label') ) \<br>        <strong class="markup--strong markup--pre-strong">+</strong> geom_point(size<strong class="markup--strong markup--pre-strong">=</strong>75,alpha<strong class="markup--strong markup--pre-strong">=</strong>0.8) \<br>        <strong class="markup--strong markup--pre-strong">+</strong> ggtitle("First and Second Principal Components colored by digit")<br>chart</code></pre><figure name="ed35" id="ed35" class="graf graf--figure graf-after--pre"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 591px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 84.39999999999999%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*lA64VdZ5w6wSEdtPVUENIQ.png" data-width="1228" data-height="1036" data-action="zoom" data-action-value="1*lA64VdZ5w6wSEdtPVUENIQ.png" data-scroll="native"><img src="./Visualising high-dimensional datasets using PCA and t-SNE in Python_files/1-lA64VdZ5w6wSEdtPVUENIQ.png" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="62"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*lA64VdZ5w6wSEdtPVUENIQ.png" src="./Visualising high-dimensional datasets using PCA and t-SNE in Python_files/1-lA64VdZ5w6wSEdtPVUENIQ(1).png"><noscript class="js-progressiveMedia-inner">&lt;img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/800/1*lA64VdZ5w6wSEdtPVUENIQ.png"&gt;</noscript></div></div></figure><p name="0b56" id="0b56" class="graf graf--p graf-after--figure">From the graph we can see the two components definitely hold some information, especially for specific digits, but clearly not enough to set all of them apart. Luckily there is another technique that we can use to reduce the number of dimensions that may prove more helpful. In the next few paragraphs we are going to take a look at that technique and explore if it gives us a better way of reducing the dimensions for visualisation. The method we will be exploring is known as t-SNE (t-Distributed Stochastic Neighbouring Entities).</p><h3 name="e911" id="e911" class="graf graf--h3 graf-after--p">T-Distributed Stochastic Neighbouring Entities&nbsp;(t-SNE)</h3><p name="99d8" id="99d8" class="graf graf--p graf-after--h3">t-Distributed Stochastic Neighbor Embedding (<a href="http://lvdmaaten.github.io/tsne/" data-href="http://lvdmaaten.github.io/tsne/" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">t-SNE</a>) is another technique for dimensionality reduction and is particularly well suited for the visualization of high-dimensional datasets. Contrary to PCA it is not a mathematical technique but a probablistic one. The <a href="http://jmlr.org/papers/volume9/vandermaaten08a/vandermaaten08a.pdf" data-href="http://jmlr.org/papers/volume9/vandermaaten08a/vandermaaten08a.pdf" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">original paper</a> describes the working of t-SNE as:</p><p name="ec7d" id="ec7d" class="graf graf--p graf-after--p"><em class="markup--em markup--p-em">t-Distributed stochastic neighbor embedding (t-SNE) minimizes the divergence between two distributions: a distribution that measures pairwise similarities of the input objects and a distribution that measures pairwise similarities of the corresponding low-dimensional points in the embedding.</em></p><p name="486f" id="486f" class="graf graf--p graf-after--p">Essentially what this means is that it looks at the original data that is entered into the algorithm and looks at how to best represent this data using less dimensions by matching both distributions. The way it does this is computationally quite heavy and therefore there are some (serious) limitations to the use of this technique. For example one of the recommendations is that, in case of very high dimensional data, you may need to apply another dimensionality reduction technique before using t-SNE:</p><pre name="1a41" id="1a41" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">|  It is highly recommended to use another dimensionality reduction<br> |  method (e.g. PCA for dense data or TruncatedSVD for sparse data)<br> |  to reduce the number of dimensions to a reasonable amount (e.g. 50)<br> |  if the number of features is very high.</code></pre><p name="4523" id="4523" class="graf graf--p graf-after--pre">The other key drawback is that it:</p><p name="48bf" id="48bf" class="graf graf--p graf-after--p"><em class="markup--em markup--p-em">Since t-SNE scales quadratically in the number of objects N, its applicability is limited to data sets with only a few thousand input objects; beyond that, learning becomes too slow to be practical (and the memory requirements become too large).</em></p><p name="fa0c" id="fa0c" class="graf graf--p graf-after--p">We will use the <a href="http://scikit-learn.org/stable/modules/generated/sklearn.manifold.TSNE.html" data-href="http://scikit-learn.org/stable/modules/generated/sklearn.manifold.TSNE.html" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">Scikit-Learn Implementation</a> of the algorithm in the remainder of this writeup.</p><p name="3667" id="3667" class="graf graf--p graf-after--p">Contrary to the recommendation above we will first try to run the algorithm on the actual dimensions of the data (784) and see how it does. To make sure we don’t burden our machine in terms of memory and power/time we will only use the first 7,000 samples to run the algorithm on.</p><pre name="c47d" id="c47d" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0"><strong class="markup--strong markup--pre-strong">import</strong> time<br><br><strong class="markup--strong markup--pre-strong">from</strong> sklearn.manifold <strong class="markup--strong markup--pre-strong">import</strong> TSNE<br><br>n_sne <strong class="markup--strong markup--pre-strong">=</strong> 7000<br><br>time_start <strong class="markup--strong markup--pre-strong">=</strong> time<strong class="markup--strong markup--pre-strong">.</strong>time()<br>tsne <strong class="markup--strong markup--pre-strong">=</strong> TSNE(n_components<strong class="markup--strong markup--pre-strong">=</strong>2, verbose<strong class="markup--strong markup--pre-strong">=</strong>1, perplexity<strong class="markup--strong markup--pre-strong">=</strong>40, n_iter<strong class="markup--strong markup--pre-strong">=</strong>300)<br>tsne_results <strong class="markup--strong markup--pre-strong">=</strong> tsne<strong class="markup--strong markup--pre-strong">.</strong>fit_transform(df<strong class="markup--strong markup--pre-strong">.</strong>loc[rndperm[:n_sne],feat_cols]<strong class="markup--strong markup--pre-strong">.</strong>values)</code></pre><pre name="4223" id="4223" class="graf graf--pre graf-after--pre"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0"><strong class="markup--strong markup--pre-strong"><br>print</strong> 't-SNE done! Time elapsed: {} seconds'<strong class="markup--strong markup--pre-strong">.</strong>format(time<strong class="markup--strong markup--pre-strong">.</strong>time()<strong class="markup--strong markup--pre-strong">-</strong>time_start)</code></pre><pre name="768a" id="768a" class="graf graf--pre graf-after--pre">[out]<br>[t-SNE] Computing pairwise distances...<br>[t-SNE] Computed conditional probabilities for sample 1000 / 7000<br>[t-SNE] Computed conditional probabilities for sample 2000 / 7000<br>[t-SNE] Computed conditional probabilities for sample 3000 / 7000<br>[t-SNE] Computed conditional probabilities for sample 4000 / 7000<br>[t-SNE] Computed conditional probabilities for sample 5000 / 7000<br>[t-SNE] Computed conditional probabilities for sample 6000 / 7000<br>[t-SNE] Computed conditional probabilities for sample 7000 / 7000<br>[t-SNE] Mean sigma: 2.170716<br>[t-SNE] Error after 97 iterations with early exaggeration: 17.891132<br>[t-SNE] Error after 300 iterations: 2.206017<br>t-SNE done! Time elapsed: 813.213096142 seconds</pre><p name="e271" id="e271" class="graf graf--p graf-after--pre">Now that we have the two resulting dimensions we can again visualise them by creating a scatter plot of the two dimensions and coloring each sample by its respective label.</p><pre name="ce81" id="ce81" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">df_tsne <strong class="markup--strong markup--pre-strong">=</strong> df<strong class="markup--strong markup--pre-strong">.</strong>loc[rndperm[:n_sne],:]<strong class="markup--strong markup--pre-strong">.</strong>copy()<br>df_tsne['x-tsne'] <strong class="markup--strong markup--pre-strong">=</strong> tsne_results[:,0]<br>df_tsne['y-tsne'] <strong class="markup--strong markup--pre-strong">=</strong> tsne_results[:,1]<br><br>chart <strong class="markup--strong markup--pre-strong">=</strong> ggplot( df_tsne, aes(x<strong class="markup--strong markup--pre-strong">=</strong>'x-tsne', y<strong class="markup--strong markup--pre-strong">=</strong>'y-tsne', color<strong class="markup--strong markup--pre-strong">=</strong>'label') ) \<br>        <strong class="markup--strong markup--pre-strong">+</strong> geom_point(size<strong class="markup--strong markup--pre-strong">=</strong>70,alpha<strong class="markup--strong markup--pre-strong">=</strong>0.1) \<br>        <strong class="markup--strong markup--pre-strong">+</strong> ggtitle("tSNE dimensions colored by digit")<br>chart</code></pre><figure name="541f" id="541f" class="graf graf--figure graf-after--pre"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 588px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 84.1%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*9RHEN1wP2KGYKhYdiNw7qQ.png" data-width="1230" data-height="1034" data-action="zoom" data-action-value="1*9RHEN1wP2KGYKhYdiNw7qQ.png" data-scroll="native"><img src="./Visualising high-dimensional datasets using PCA and t-SNE in Python_files/1-9RHEN1wP2KGYKhYdiNw7qQ.png" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="62"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*9RHEN1wP2KGYKhYdiNw7qQ.png" src="./Visualising high-dimensional datasets using PCA and t-SNE in Python_files/1-9RHEN1wP2KGYKhYdiNw7qQ(1).png"><noscript class="js-progressiveMedia-inner">&lt;img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/800/1*9RHEN1wP2KGYKhYdiNw7qQ.png"&gt;</noscript></div></div></figure><p name="88da" id="88da" class="graf graf--p graf-after--figure">This is already a significant improvement over the PCA visualisation we used earlier. We can see that the digits are very clearly clustered in their own little group. If we would now use a clustering algorithm to pick out the seperate clusters we could probably quite accurately assign new points to a label.</p><p name="6a76" id="6a76" class="graf graf--p graf-after--p">We’ll now take the recommandations to heart and actually reduce the number of dimensions before feeding the data into the t-SNE algorithm. For this we’ll use PCA again. We will first create a new dataset containing the fifty dimensions generated by the PCA reduction algorithm. We can then use this dataset to perform the t-SNE on</p><pre name="880a" id="880a" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">pca_50 <strong class="markup--strong markup--pre-strong">=</strong> PCA(n_components<strong class="markup--strong markup--pre-strong">=</strong>50)<br>pca_result_50 <strong class="markup--strong markup--pre-strong">=</strong> pca_50<strong class="markup--strong markup--pre-strong">.</strong>fit_transform(df[feat_cols]<strong class="markup--strong markup--pre-strong">.</strong>values)</code></pre><pre name="4d4e" id="4d4e" class="graf graf--pre graf-after--pre"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0"><br><strong class="markup--strong markup--pre-strong">print</strong> 'Explained variation per principal component (PCA): {}'<strong class="markup--strong markup--pre-strong">.</strong>format(np<strong class="markup--strong markup--pre-strong">.</strong>sum(pca_50<strong class="markup--strong markup--pre-strong">.</strong>explained_variance_ratio_))</code></pre><pre name="bdde" id="bdde" class="graf graf--pre graf-after--pre"><br>[out] Explained variation per principal component (PCA): 84.6676222833%</pre><p name="7e59" id="7e59" class="graf graf--p graf-after--pre">Amazingly, the first 50 components roughly hold around 85% of the total variation in the data.</p><p name="bd61" id="bd61" class="graf graf--p graf-after--p">Now lets try and feed this data into the t-SNE algorithm. This time we’ll use 10,000 samples out of the 70,000 to make sure the algorithm does not take up too much memory and CPU. Since the code used for this is very similar to the previous t-SNE code I have moved it to the Appendix: Code section at the bottom of this post. The plot it produced is the following one:</p><figure name="9c37" id="9c37" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 576px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 82.19999999999999%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*OvotzpNWbWE8wZht7Pw3_Q.png" data-width="1250" data-height="1028" data-action="zoom" data-action-value="1*OvotzpNWbWE8wZht7Pw3_Q.png" data-scroll="native"><img src="./Visualising high-dimensional datasets using PCA and t-SNE in Python_files/1-OvotzpNWbWE8wZht7Pw3_Q.png" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="60"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*OvotzpNWbWE8wZht7Pw3_Q.png" src="./Visualising high-dimensional datasets using PCA and t-SNE in Python_files/1-OvotzpNWbWE8wZht7Pw3_Q(1).png"><noscript class="js-progressiveMedia-inner">&lt;img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/800/1*OvotzpNWbWE8wZht7Pw3_Q.png"&gt;</noscript></div></div></figure><p name="4de5" id="4de5" class="graf graf--p graf-after--figure">From this plot we can clearly see how all the samples are nicely spaced apart and grouped together with their respective digits. This could be an amazing starting point to then use a clustering algorithm and try to identify the clusters or to actually use these two dimensions as input to another algorithm (e.g., something like a Neural Network).</p><p name="dfa6" id="dfa6" class="graf graf--p graf-after--p">So we have explored using various dimensionality reduction techniques to visualise high-dimensional data using a two-dimensional scatter plot. We have not gone into the actual mathematics involved but instead relied on the Scikit-Learn implementations of all algorithms.</p><h3 name="1007" id="1007" class="graf graf--h3 graf-after--p">Appendix: Code</h3><p name="ac9c" id="ac9c" class="graf graf--p graf-after--h3">Code: t-SNE on PCA-reduced data</p><pre name="d074" id="d074" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">n_sne <strong class="markup--strong markup--pre-strong">=</strong> 10000<br><br>time_start <strong class="markup--strong markup--pre-strong">=</strong> time<strong class="markup--strong markup--pre-strong">.</strong>time()<br><br>tsne <strong class="markup--strong markup--pre-strong">=</strong> TSNE(n_components<strong class="markup--strong markup--pre-strong">=</strong>2, verbose<strong class="markup--strong markup--pre-strong">=</strong>1, perplexity<strong class="markup--strong markup--pre-strong">=</strong>40, n_iter<strong class="markup--strong markup--pre-strong">=</strong>300)<br>tsne_pca_results <strong class="markup--strong markup--pre-strong">=</strong> tsne<strong class="markup--strong markup--pre-strong">.</strong>fit_transform(pca_result_50[rndperm[:n_sne]])</code></pre><pre name="ace7" id="ace7" class="graf graf--pre graf-after--pre"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0"><br><strong class="markup--strong markup--pre-strong">print</strong> 't-SNE done! Time elapsed: {} seconds'<strong class="markup--strong markup--pre-strong">.</strong>format(time<strong class="markup--strong markup--pre-strong">.</strong>time()<strong class="markup--strong markup--pre-strong">-</strong>time_start)</code></pre><pre name="b891" id="b891" class="graf graf--pre graf-after--pre">[out]<br>[t-SNE] Computing pairwise distances...<br>[t-SNE] Computed conditional probabilities for sample 1000 / 10000<br>[...]<br>[t-SNE] Computed conditional probabilities for sample 10000 / 10000<br>[t-SNE] Mean sigma: 1.814452<br>[t-SNE] Error after 100 iterations with early exaggeration: 18.725542<br>[t-SNE] Error after 300 iterations: 2.657761<br>t-SNE done! Time elapsed: 1620.80310392 seconds</pre><p name="bd29" id="bd29" class="graf graf--p graf-after--pre">And for the visualisation</p><pre name="a0c5" id="a0c5" class="graf graf--pre graf-after--p graf--trailing"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">df_tsne <strong class="markup--strong markup--pre-strong">=</strong> None<br>df_tsne <strong class="markup--strong markup--pre-strong">=</strong> df<strong class="markup--strong markup--pre-strong">.</strong>loc[rndperm[:n_sne],:]<strong class="markup--strong markup--pre-strong">.</strong>copy()<br>df_tsne['x-tsne-pca'] <strong class="markup--strong markup--pre-strong">=</strong> tsne_pca_results[:,0]<br>df_tsne['y-tsne-pca'] <strong class="markup--strong markup--pre-strong">=</strong> tsne_pca_results[:,1]<br><br>chart <strong class="markup--strong markup--pre-strong">=</strong> ggplot( df_tsne, aes(x<strong class="markup--strong markup--pre-strong">=</strong>'x-tsne-pca', y<strong class="markup--strong markup--pre-strong">=</strong>'y-tsne-pca', color<strong class="markup--strong markup--pre-strong">=</strong>'label') ) \<br>        <strong class="markup--strong markup--pre-strong">+</strong> geom_point(size<strong class="markup--strong markup--pre-strong">=</strong>70,alpha<strong class="markup--strong markup--pre-strong">=</strong>0.1) \<br>        <strong class="markup--strong markup--pre-strong">+</strong> ggtitle("tSNE dimensions colored by Digit (PCA)")<br>chart</code></pre></div></div></section></div><footer class="u-paddingTop10"><div class="container u-maxWidth740"><div class="row"><div class="col u-size12of12"></div></div><div class="row"><div class="col u-size12of12 js-postTags"><div class="u-paddingBottom10"><ul class="tags tags--postTags tags--borderless"><li><a class="link u-baseColor--link" href="https://medium.com/tag/data-science?source=post" data-action-source="post">Data Science</a></li><li><a class="link u-baseColor--link" href="https://medium.com/tag/machine-learning?source=post" data-action-source="post">Machine Learning</a></li><li><a class="link u-baseColor--link" href="https://medium.com/tag/data-visualization?source=post" data-action-source="post">Data Visualization</a></li></ul></div></div></div><div class="row js-postActionsFooter"><div class="postActions col u-size12of12"><div class="u-floatLeft buttonSet buttonSet--withLabels"><div class="buttonSet-inner"><div class="js-actionRecommend" data-post-id="8ef87e7915b" data-is-icon-29px="true" data-has-recommend-list="true" data-source="post_actions_footer"><button class="button button--primary button--large button--chromeless is-touchIconFadeInPulse u-accentColor--buttonNormal button--withIcon button--withSvgIcon u-accentColor--iconLight js-actionRecommendButton" title="Recommend to share this article with your followers and let the author know you liked it" aria-label="Recommend to share this article with your followers and let the author know you liked it" data-action="sign-in-prompt" data-sign-in-action="upvote" data-requires-token="true" data-redirect="https://medium.com/_/vote/p/8ef87e7915b" data-action-source="post_actions_footer"><span class="button-defaultState"><span class="svgIcon svgIcon--heart svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M16.215 23.716c-.348.288-.984.826-1.376 1.158a.526.526 0 0 1-.68 0c-.36-.307-.92-.78-1.22-1.03C9.22 20.734 3 15.527 3 10.734 3 7.02 5.916 4 9.5 4c1.948 0 3.77.898 5 2.434C15.73 4.898 17.552 4 19.5 4c3.584 0 6.5 3.02 6.5 6.734 0 4.9-6.125 9.96-9.785 12.982zM19.5 5.2c-1.774 0-3.423.923-4.41 2.468a.699.699 0 0 1-.59.323.706.706 0 0 1-.59-.32c-.988-1.54-2.637-2.47-4.41-2.47-2.922 0-5.3 2.49-5.3 5.54 0 4.23 6.19 9.41 9.517 12.19.217.18.566.48.783.66l.952-.79c3.496-2.88 9.348-7.72 9.348-12.05 0-3.05-2.378-5.53-5.3-5.53z"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--heartFilled svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M19.5 4c-1.948 0-3.77.898-5 2.434C13.27 4.898 11.448 4 9.5 4 5.916 4 3 7.02 3 10.734c0 4.793 6.227 10 9.95 13.11.296.25.853.723 1.212 1.03.196.166.48.166.677 0 .39-.332 1.02-.87 1.37-1.158 3.66-3.022 9.79-8.08 9.79-12.982C26 7.02 23.08 4 19.5 4z" fill-rule="evenodd"></path></svg></span></span></button><button class="button button--chromeless u-baseColor--buttonNormal" data-action="show-recommends" data-action-value="8ef87e7915b">6</button></div></div><div class="buttonSet-inner"><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon" data-action="scroll-to-responses" data-action-source="post_actions_footer"><span class="svgIcon svgIcon--response svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M21.27 20.058c1.89-1.826 2.754-4.17 2.754-6.674C24.024 8.21 19.67 4 14.1 4 8.53 4 4 8.21 4 13.384c0 5.175 4.53 9.385 10.1 9.385 1.007 0 2-.14 2.95-.41.285.25.592.49.918.7 1.306.87 2.716 1.31 4.19 1.31.276-.01.494-.14.6-.36a.625.625 0 0 0-.052-.65c-.61-.84-1.042-1.71-1.282-2.58a5.417 5.417 0 0 1-.154-.75zm-3.85 1.324l-.083-.28-.388.12a9.72 9.72 0 0 1-2.85.424c-4.96 0-8.99-3.706-8.99-8.262 0-4.556 4.03-8.263 8.99-8.263 4.95 0 8.77 3.71 8.77 8.27 0 2.25-.75 4.35-2.5 5.92l-.24.21v.32c0 .07 0 .19.02.37.03.29.1.6.19.92.19.7.49 1.4.89 2.08-.93-.14-1.83-.49-2.67-1.06-.34-.22-.88-.48-1.16-.74z"></path></svg></span></button></div></div><div class="u-floatRight buttonSet buttonSet--narrow"><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon" title="Share on Twitter" aria-label="Share on Twitter" data-action="share-on-twitter" data-action-source="post_actions_footer"><span class="svgIcon svgIcon--twitter svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M21.967 11.8c.018 5.93-4.607 11.18-11.177 11.18-2.172 0-4.25-.62-6.047-1.76l-.268.422-.038.5.186.013.168.012c.3.02.44.032.6.046 2.06-.026 3.95-.686 5.49-1.86l1.12-.85-1.4-.048c-1.57-.055-2.92-1.08-3.36-2.51l-.48.146-.05.5c.22.03.48.05.75.08.48-.02.87-.07 1.25-.15l2.33-.49-2.32-.49c-1.68-.35-2.91-1.83-2.91-3.55 0-.05 0-.01-.01.03l-.49-.1-.25.44c.63.36 1.35.57 2.07.58l1.7.04L7.4 13c-.978-.662-1.59-1.79-1.618-3.047a4.08 4.08 0 0 1 .524-1.8l-.825.07a12.188 12.188 0 0 0 8.81 4.515l.59.033-.06-.59v-.02c-.05-.43-.06-.63-.06-.87a3.617 3.617 0 0 1 6.27-2.45l.2.21.28-.06c1.01-.22 1.94-.59 2.73-1.09l-.75-.56c-.1.36-.04.89.12 1.36.23.68.58 1.13 1.17.85l-.21-.45-.42-.27c-.52.8-1.17 1.48-1.92 2L22 11l.016.28c.013.2.014.35 0 .52v.04zm.998.038c.018-.22.017-.417 0-.66l-.498.034.284.41a8.183 8.183 0 0 0 2.2-2.267l.97-1.48-1.6.755c.17-.08.3-.02.34.03a.914.914 0 0 1-.13-.292c-.1-.297-.13-.64-.1-.766l.36-1.254-1.1.695c-.69.438-1.51.764-2.41.963l.48.15a4.574 4.574 0 0 0-3.38-1.484 4.616 4.616 0 0 0-4.61 4.613c0 .29.02.51.08.984l.01.02.5-.06.03-.5c-3.17-.18-6.1-1.7-8.08-4.15l-.48-.56-.36.64c-.39.69-.62 1.48-.65 2.28.04 1.61.81 3.04 2.06 3.88l.3-.92c-.55-.02-1.11-.17-1.6-.45l-.59-.34-.14.67c-.02.08-.02.16 0 .24-.01 2.12 1.55 4.01 3.69 4.46l.1-.49-.1-.49c-.33.07-.67.12-1.03.14-.18-.02-.43-.05-.64-.07l-.76-.09.23.73c.57 1.84 2.29 3.14 4.28 3.21l-.28-.89a8.252 8.252 0 0 1-4.85 1.66c-.12-.01-.26-.02-.56-.05l-.17-.01-.18-.01L2.53 21l1.694 1.07a12.233 12.233 0 0 0 6.58 1.917c7.156 0 12.2-5.73 12.18-12.18l-.002.04z"></path></svg></span></button><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon" title="Share on Facebook" aria-label="Share on Facebook" data-action="share-on-facebook" data-action-source="post_actions_footer"><span class="svgIcon svgIcon--facebook svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M16.39 23.61v-5.808h1.846a.55.55 0 0 0 .546-.48l.36-2.797a.551.551 0 0 0-.547-.62H16.39V12.67c0-.67.12-.813.828-.813h1.474a.55.55 0 0 0 .55-.55V8.803a.55.55 0 0 0-.477-.545c-.436-.06-1.36-.116-2.22-.116-2.5 0-4.13 1.62-4.13 4.248v1.513H10.56a.551.551 0 0 0-.55.55v2.797c0 .304.248.55.55.55h1.855v5.76c-4.172-.96-7.215-4.7-7.215-9.1 0-5.17 4.17-9.36 9.31-9.36 5.14 0 9.31 4.19 9.31 9.36 0 4.48-3.155 8.27-7.43 9.15M14.51 4C8.76 4 4.1 8.684 4.1 14.46c0 5.162 3.75 9.523 8.778 10.32a.55.55 0 0 0 .637-.543v-6.985a.551.551 0 0 0-.55-.55H11.11v-1.697h1.855a.55.55 0 0 0 .55-.55v-2.063c0-2.02 1.136-3.148 3.03-3.148.567 0 1.156.027 1.597.06v1.453h-.924c-1.363 0-1.93.675-1.93 1.912v1.78c0 .3.247.55.55.55h2.132l-.218 1.69H15.84c-.305 0-.55.24-.55.55v7.02c0 .33.293.59.623.54 5.135-.7 9.007-5.11 9.007-10.36C24.92 8.68 20.26 4 14.51 4"></path></svg></span></button></div></div></div></div><div class="js-postPromotionWrapper postPromotionWrapper" data-location-id="footer_above_post_attribution"></div><div class="container u-maxWidth740 js-postAttributionFooterContainer u-paddingTop20 u-paddingBottom20 u-marginTop10 u-borderTopLightest u-xs-paddingTop10 u-xs-paddingBottom10"><div class="row js-postFooterInfo"><div class="col u-size12of12"><li class="u-block u-paddingBottom18 js-cardUser"><div class="u-marginLeft20 u-floatRight"><span class="followState js-followState buttonSet-inner" data-user-id="c85c6404c0f9"><button class="button button--small u-noUserSelect button--withChrome u-baseColor--buttonNormal button--withHover button--unblock js-unblockButton" data-action="sign-in-prompt" data-sign-in-action="toggle-block-user" data-requires-token="true" data-action-source="footer_card"><span class="button-label  button-defaultState">Blocked</span><span class="button-label button-hoverState">Unblock</span></button><button class="button button--primary button--small u-noUserSelect button--withChrome u-accentColor--buttonNormal button--follow js-followButton" data-action="sign-in-prompt" data-sign-in-action="toggle-subscribe-user" data-requires-token="true" data-redirect="https://medium.com/_/subscribe/user/c85c6404c0f9" data-action-source="footer_card_follow"><span class="button-label  button-defaultState js-buttonLabel">Follow</span><span class="button-label button-activeState">Following</span></button></span></div><div class="u-tableCell "><a class="link avatar u-baseColor--link" href="https://medium.com/@luckylwk?source=footer_card" title="Go to the profile of Luuk Derksen" aria-label="Go to the profile of Luuk Derksen" data-action-source="footer_card" data-user-id="c85c6404c0f9" dir="auto"><img src="./Visualising high-dimensional datasets using PCA and t-SNE in Python_files/0-E-t7oTrRvLnQ3qky.jpeg" class="avatar-image avatar-image--small" alt="Go to the profile of Luuk Derksen"></a></div><div class="u-tableCell u-verticalAlignMiddle u-breakWord u-paddingLeft15"><h3 class="u-fontSize18 u-lineHeightTighter u-marginBottom4"><a class="link link--primary u-accentColor--hoverTextNormal" href="https://medium.com/@luckylwk" property="cc:attributionName" title="Go to the profile of Luuk Derksen" aria-label="Go to the profile of Luuk Derksen" rel="author cc:attributionUrl" data-user-id="c85c6404c0f9" dir="auto">Luuk Derksen</a></h3><p class="u-fontSize14 u-lineHeightBaseSans u-textColorDark u-marginBottom4">Data (Scientist) junky. All views my own. | PGP: <a rel="nofollow" href="http://goo.gl/CMdQR7">http://goo.gl/CMdQR7</a></p></div></li></div></div></div><div class="js-postFooterPlacements" data-action-scope="_actionscope_6"><div class="streamItem streamItem--placementCardGrid js-streamItem"><div class="u-clearfix u-backgroundGrayLightest"><div class="row u-marginAuto u-maxWidth1000 u-paddingTop30 u-paddingBottom40"><div class="col u-padding8 u-xs-size12of12 u-size4of12"><div class="u-height280 u-sizeFullWidth u-backgroundWhite u-borderCardBorder u-boxShadow u-borderBox u-borderRadius4 js-trackedPost" data-post-id="2a85ec4776d6" data-source="placement_card_footer_grid---------0-44" data-tracking-context="placement" data-scroll="native"><div class="u-padding15 u-borderBox u-flexColumn u-sizeFull"><a class="link link--noUnderline u-flex1 u-flexColumn u-baseColor--link" href="https://medium.com/golog/demonstrating-practical-buffer-overflows-in-word-2007-2a85ec4776d6?source=placement_card_footer_grid---------0-44" data-action-source="placement_card_footer_grid---------0-44"><div class="postMetaInline u-marginBottom7">More from Luuk Derksen</div><div class="u-textColorDarkest u-contentSansBold u-fontSize24 u-maxHeight2LineHeightTighter u-lineClamp2 u-textOverflowEllipsis u-letterSpacingTight u-paddingBottom2">Demonstrating Practical Buffer Overflows in Word 2007</div><div class="u-textColorNormal u-fontSize22 u-contentSansThin u-maxHeight2LineHeightTighter u-lineClamp2 u-textOverflowEllipsis u-letterSpacingTight u-marginTop7 u-paddingBottom2">Written: January 14, 2016</div></a><div class="u-paddingTop10 u-flex0 u-flexCenter"><div class="u-flex1"><div class="u-flexCenter"><div class="postMetaInline-avatar u-flex0"><a class="link avatar u-baseColor--link" href="https://medium.com/@luckylwk" data-action="show-user-card" data-action-value="c85c6404c0f9" data-action-type="hover" data-user-id="c85c6404c0f9" dir="auto"><img src="./Visualising high-dimensional datasets using PCA and t-SNE in Python_files/0-E-t7oTrRvLnQ3qky(1).jpeg" class="avatar-image u-size36x36 u-xs-size32x32" alt="Go to the profile of Luuk Derksen"></a></div><div class="postMetaInline postMetaInline-authorLockup u-flex1 u-noWrapWithEllipsis"><a class="link link link--darken link--darker u-baseColor--link" href="https://medium.com/@luckylwk?source=placement_card_footer_grid---------0-44" data-action="show-user-card" data-action-source="placement_card_footer_grid---------0-44" data-action-value="c85c6404c0f9" data-action-type="hover" data-user-id="c85c6404c0f9" dir="auto">Luuk Derksen</a><div class="u-fontSize12 u-baseColor--textNormal u-textColorNormal js-postMetaInlineSupplemental"><span class="readingTime u-textColorNormal" title="4 min read"></span></div></div></div></div><div class="u-flex0 u-flexCenter"><div class="buttonSet"><div class="js-actionRecommend" data-post-id="2a85ec4776d6" data-is-label-padded="true" data-source="placement_card_footer_grid---------0-44"><button class="button button--primary button--chromeless is-touchIconFadeInPulse u-accentColor--buttonNormal button--withIcon button--withSvgIcon u-accentColor--iconLight js-actionRecommendButton" title="Recommend to share this article with your followers and let the author know you liked it" aria-label="Recommend to share this article with your followers and let the author know you liked it" data-action="sign-in-prompt" data-sign-in-action="upvote" data-requires-token="true" data-redirect="https://medium.com/_/vote/p/2a85ec4776d6" data-action-source="placement_card_footer_grid---------0-44"><span class="button-defaultState"><span class="svgIcon svgIcon--heart svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M12.5 21a.492.492 0 0 1-.327-.122c-.278-.24-.61-.517-.978-.826-2.99-2.5-7.995-6.684-7.995-10.565C3.2 6.462 5.578 4 8.5 4c1.55 0 3 .695 4 1.89a5.21 5.21 0 0 1 4-1.89c2.923 0 5.3 2.462 5.3 5.487 0 3.97-4.923 8.035-7.865 10.464-.42.35-.798.66-1.108.93a.503.503 0 0 1-.327.12zM8.428 4.866c-2.414 0-4.378 2.05-4.378 4.568 0 3.475 5.057 7.704 7.774 9.975.243.2.47.39.676.56.245-.21.52-.43.813-.68 2.856-2.36 7.637-6.31 7.637-9.87 0-2.52-1.964-4.57-4.377-4.57-1.466 0-2.828.76-3.644 2.04-.1.14-.26.23-.43.23-.18 0-.34-.09-.43-.24-.82-1.27-2.18-2.03-3.65-2.03z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--heartFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M12.5 21a.492.492 0 0 1-.327-.122c-.278-.24-.61-.517-.978-.826-2.99-2.5-7.995-6.684-7.995-10.565C3.2 6.462 5.578 4 8.5 4c1.55 0 3 .695 4 1.89a5.21 5.21 0 0 1 4-1.89c2.923 0 5.3 2.462 5.3 5.487 0 3.97-4.923 8.035-7.865 10.464-.42.35-.798.66-1.108.93a.503.503 0 0 1-.327.12z" fill-rule="evenodd"></path></svg></span></span></button><button class="button button--chromeless u-baseColor--buttonNormal u-disablePointerEvents u-marginLeft4" data-action="show-recommends" data-action-value="2a85ec4776d6">2</button></div></div><div class="u-height20 u-borderRightLighter u-inlineBlock u-relative u-marginRight10 u-marginLeft12"></div><div class="buttonSet"><button class="button button--chromeless is-touchIconFadeInPulse u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="sign-in-prompt" data-sign-in-action="add-to-bookmarks" data-requires-token="true" data-redirect="https://medium.com/_/bookmark/p/2a85ec4776d6"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126a.508.508 0 0 0 .708-.03.5.5 0 0 0 .118-.285H19V6zm-6.838 9.97L7 19.636V6c0-.55.45-1 1-1h9c.55 0 1 .45 1 1v13.637l-5.162-3.668a.49.49 0 0 0-.676 0z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="26" viewBox="0 0 25 26"><path d="M19 7c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 17.85l5.662 4.126a.508.508 0 0 0 .708-.03.5.5 0 0 0 .118-.285H19V7z" fill-rule="evenodd"></path></svg></span></span></button></div></div></div></div></div></div><div class="col u-padding8 u-xs-size12of12 u-size4of12"><div class="u-height280 u-sizeFullWidth u-backgroundWhite u-borderCardBorder u-boxShadow u-borderBox u-borderRadius4 js-trackedPost" data-post-id="c47718cb95a5" data-source="placement_card_footer_grid---------1-43" data-tracking-context="placement" data-scroll="native"><a class="link link--noUnderline u-baseColor--link" href="https://medium.com/@karpathy/alphago-in-context-c47718cb95a5?source=placement_card_footer_grid---------1-43" data-action-source="placement_card_footer_grid---------1-43"><div class="u-backgroundCover u-backgroundColorGrayLight u-height100 u-sizeFullWidth u-borderBottomLight u-borderRadiusTop4" style="background-image: url(&quot;https://cdn-images-1.medium.com/fit/c/400/120/1*B6aiZqCgv7jUmbzfeEpdTg.png&quot;); background-position: 50% 50% !important;"></div></a><div class="u-padding15 u-borderBox u-flexColumn u-height180"><a class="link link--noUnderline u-flex1 u-baseColor--link" href="https://medium.com/@karpathy/alphago-in-context-c47718cb95a5?source=placement_card_footer_grid---------1-43" data-action-source="placement_card_footer_grid---------1-43"><div class="postMetaInline u-marginBottom7">Also tagged Machine Learning</div><div class="u-textColorDarkest u-contentSansBold u-fontSize24 u-maxHeight2LineHeightTighter u-lineClamp2 u-textOverflowEllipsis u-letterSpacingTight u-paddingBottom2">AlphaGo, in context</div></a><div class="u-paddingTop10 u-flex0 u-flexCenter"><div class="u-flex1"><div class="u-flexCenter"><div class="postMetaInline-avatar u-flex0"><a class="link avatar u-baseColor--link" href="https://medium.com/@karpathy" data-action="show-user-card" data-action-value="ac9d9a35533e" data-action-type="hover" data-user-id="ac9d9a35533e" dir="auto"><img src="./Visualising high-dimensional datasets using PCA and t-SNE in Python_files/0-8ldFdx9B6FhSkQmV.jpeg" class="avatar-image u-size36x36 u-xs-size32x32" alt="Go to the profile of Andrej Karpathy"></a></div><div class="postMetaInline postMetaInline-authorLockup u-flex1 u-noWrapWithEllipsis"><a class="link link link--darken link--darker u-baseColor--link" href="https://medium.com/@karpathy?source=placement_card_footer_grid---------1-43" data-action="show-user-card" data-action-source="placement_card_footer_grid---------1-43" data-action-value="ac9d9a35533e" data-action-type="hover" data-user-id="ac9d9a35533e" dir="auto">Andrej Karpathy</a><div class="u-fontSize12 u-baseColor--textNormal u-textColorNormal js-postMetaInlineSupplemental"><span class="readingTime u-textColorNormal" title="5 min read"></span></div></div></div></div><div class="u-flex0 u-flexCenter"><div class="buttonSet"><div class="js-actionRecommend" data-post-id="c47718cb95a5" data-is-label-padded="true" data-source="placement_card_footer_grid---------1-43"><button class="button button--primary button--chromeless is-touchIconFadeInPulse u-accentColor--buttonNormal button--withIcon button--withSvgIcon u-accentColor--iconLight js-actionRecommendButton" title="Recommend to share this article with your followers and let the author know you liked it" aria-label="Recommend to share this article with your followers and let the author know you liked it" data-action="sign-in-prompt" data-sign-in-action="upvote" data-requires-token="true" data-redirect="https://medium.com/_/vote/p/c47718cb95a5" data-action-source="placement_card_footer_grid---------1-43"><span class="button-defaultState"><span class="svgIcon svgIcon--heart svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M12.5 21a.492.492 0 0 1-.327-.122c-.278-.24-.61-.517-.978-.826-2.99-2.5-7.995-6.684-7.995-10.565C3.2 6.462 5.578 4 8.5 4c1.55 0 3 .695 4 1.89a5.21 5.21 0 0 1 4-1.89c2.923 0 5.3 2.462 5.3 5.487 0 3.97-4.923 8.035-7.865 10.464-.42.35-.798.66-1.108.93a.503.503 0 0 1-.327.12zM8.428 4.866c-2.414 0-4.378 2.05-4.378 4.568 0 3.475 5.057 7.704 7.774 9.975.243.2.47.39.676.56.245-.21.52-.43.813-.68 2.856-2.36 7.637-6.31 7.637-9.87 0-2.52-1.964-4.57-4.377-4.57-1.466 0-2.828.76-3.644 2.04-.1.14-.26.23-.43.23-.18 0-.34-.09-.43-.24-.82-1.27-2.18-2.03-3.65-2.03z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--heartFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M12.5 21a.492.492 0 0 1-.327-.122c-.278-.24-.61-.517-.978-.826-2.99-2.5-7.995-6.684-7.995-10.565C3.2 6.462 5.578 4 8.5 4c1.55 0 3 .695 4 1.89a5.21 5.21 0 0 1 4-1.89c2.923 0 5.3 2.462 5.3 5.487 0 3.97-4.923 8.035-7.865 10.464-.42.35-.798.66-1.108.93a.503.503 0 0 1-.327.12z" fill-rule="evenodd"></path></svg></span></span></button><button class="button button--chromeless u-baseColor--buttonNormal u-disablePointerEvents u-marginLeft4" data-action="show-recommends" data-action-value="c47718cb95a5">135</button></div></div><div class="u-height20 u-borderRightLighter u-inlineBlock u-relative u-marginRight10 u-marginLeft12"></div><div class="buttonSet"><button class="button button--chromeless is-touchIconFadeInPulse u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="sign-in-prompt" data-sign-in-action="add-to-bookmarks" data-requires-token="true" data-redirect="https://medium.com/_/bookmark/p/c47718cb95a5"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126a.508.508 0 0 0 .708-.03.5.5 0 0 0 .118-.285H19V6zm-6.838 9.97L7 19.636V6c0-.55.45-1 1-1h9c.55 0 1 .45 1 1v13.637l-5.162-3.668a.49.49 0 0 0-.676 0z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="26" viewBox="0 0 25 26"><path d="M19 7c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 17.85l5.662 4.126a.508.508 0 0 0 .708-.03.5.5 0 0 0 .118-.285H19V7z" fill-rule="evenodd"></path></svg></span></span></button></div></div></div></div></div></div><div class="col u-padding8 u-xs-size12of12 u-size4of12"><div class="u-height280 u-sizeFullWidth u-backgroundWhite u-borderCardBorder u-boxShadow u-borderBox u-borderRadius4 js-trackedPost" data-post-id="c3d67795cceb" data-source="placement_card_footer_grid---------2-43" data-tracking-context="placement" data-scroll="native"><a class="link link--noUnderline u-baseColor--link" href="https://medium.com/airbnb-engineering/selection-bias-in-online-experimentation-c3d67795cceb?source=placement_card_footer_grid---------2-43" data-action-source="placement_card_footer_grid---------2-43"><div class="u-backgroundCover u-backgroundColorGrayLight u-height100 u-sizeFullWidth u-borderBottomLight u-borderRadiusTop4" style="background-image: url(&quot;https://cdn-images-1.medium.com/fit/c/400/120/0*t_UK5R25ThlMgcZF.&quot;); background-position: 50% 50% !important;"></div></a><div class="u-padding15 u-borderBox u-flexColumn u-height180"><a class="link link--noUnderline u-flex1 u-baseColor--link" href="https://medium.com/airbnb-engineering/selection-bias-in-online-experimentation-c3d67795cceb?source=placement_card_footer_grid---------2-43" data-action-source="placement_card_footer_grid---------2-43"><div class="postMetaInline u-marginBottom7">Also tagged Data Science</div><div class="u-textColorDarkest u-contentSansBold u-fontSize24 u-maxHeight2LineHeightTighter u-lineClamp2 u-textOverflowEllipsis u-letterSpacingTight u-paddingBottom2">Selection Bias in Online Experimentation</div></a><div class="u-paddingTop10 u-flex0 u-flexCenter"><div class="u-flex1"><div class="u-flexCenter"><div class="postMetaInline-avatar u-flex0"><a class="link avatar u-baseColor--link" href="https://medium.com/@shenmilan" data-action="show-user-card" data-action-value="9925af9b349d" data-action-type="hover" data-user-id="9925af9b349d" dir="auto"><img src="./Visualising high-dimensional datasets using PCA and t-SNE in Python_files/0-YvDXsqZ3e0yGKtRB.jpeg" class="avatar-image u-size36x36 u-xs-size32x32" alt="Go to the profile of Milan Shen"></a></div><div class="postMetaInline postMetaInline-authorLockup u-flex1 u-noWrapWithEllipsis"><a class="link link link--darken link--darker u-baseColor--link" href="https://medium.com/@shenmilan?source=placement_card_footer_grid---------2-43" data-action="show-user-card" data-action-source="placement_card_footer_grid---------2-43" data-action-value="9925af9b349d" data-action-type="hover" data-user-id="9925af9b349d" dir="auto">Milan Shen</a><div class="u-fontSize12 u-baseColor--textNormal u-textColorNormal js-postMetaInlineSupplemental"><span class="readingTime u-textColorNormal" title="12 min read"></span></div></div></div></div><div class="u-flex0 u-flexCenter"><div class="buttonSet"><div class="js-actionRecommend" data-post-id="c3d67795cceb" data-is-label-padded="true" data-source="placement_card_footer_grid---------2-43"><button class="button button--primary button--chromeless is-touchIconFadeInPulse u-accentColor--buttonNormal button--withIcon button--withSvgIcon u-accentColor--iconLight js-actionRecommendButton" title="Recommend to share this article with your followers and let the author know you liked it" aria-label="Recommend to share this article with your followers and let the author know you liked it" data-action="sign-in-prompt" data-sign-in-action="upvote" data-requires-token="true" data-redirect="https://medium.com/_/vote/p/c3d67795cceb" data-action-source="placement_card_footer_grid---------2-43"><span class="button-defaultState"><span class="svgIcon svgIcon--heart svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M12.5 21a.492.492 0 0 1-.327-.122c-.278-.24-.61-.517-.978-.826-2.99-2.5-7.995-6.684-7.995-10.565C3.2 6.462 5.578 4 8.5 4c1.55 0 3 .695 4 1.89a5.21 5.21 0 0 1 4-1.89c2.923 0 5.3 2.462 5.3 5.487 0 3.97-4.923 8.035-7.865 10.464-.42.35-.798.66-1.108.93a.503.503 0 0 1-.327.12zM8.428 4.866c-2.414 0-4.378 2.05-4.378 4.568 0 3.475 5.057 7.704 7.774 9.975.243.2.47.39.676.56.245-.21.52-.43.813-.68 2.856-2.36 7.637-6.31 7.637-9.87 0-2.52-1.964-4.57-4.377-4.57-1.466 0-2.828.76-3.644 2.04-.1.14-.26.23-.43.23-.18 0-.34-.09-.43-.24-.82-1.27-2.18-2.03-3.65-2.03z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--heartFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M12.5 21a.492.492 0 0 1-.327-.122c-.278-.24-.61-.517-.978-.826-2.99-2.5-7.995-6.684-7.995-10.565C3.2 6.462 5.578 4 8.5 4c1.55 0 3 .695 4 1.89a5.21 5.21 0 0 1 4-1.89c2.923 0 5.3 2.462 5.3 5.487 0 3.97-4.923 8.035-7.865 10.464-.42.35-.798.66-1.108.93a.503.503 0 0 1-.327.12z" fill-rule="evenodd"></path></svg></span></span></button><button class="button button--chromeless u-baseColor--buttonNormal u-disablePointerEvents u-marginLeft4" data-action="show-recommends" data-action-value="c3d67795cceb">57</button></div></div><div class="u-height20 u-borderRightLighter u-inlineBlock u-relative u-marginRight10 u-marginLeft12"></div><div class="buttonSet"><button class="button button--chromeless is-touchIconFadeInPulse u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="sign-in-prompt" data-sign-in-action="add-to-bookmarks" data-requires-token="true" data-redirect="https://medium.com/_/bookmark/p/c3d67795cceb"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126a.508.508 0 0 0 .708-.03.5.5 0 0 0 .118-.285H19V6zm-6.838 9.97L7 19.636V6c0-.55.45-1 1-1h9c.55 0 1 .45 1 1v13.637l-5.162-3.668a.49.49 0 0 0-.676 0z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="26" viewBox="0 0 25 26"><path d="M19 7c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 17.85l5.662 4.126a.508.508 0 0 0 .708-.03.5.5 0 0 0 .118-.285H19V7z" fill-rule="evenodd"></path></svg></span></span></button></div></div></div></div></div></div></div></div></div></div><div class="u-padding0 u-clearfix u-backgroundGrayLightest u-print-hide supplementalPostContent js-responsesWrapper" data-action-scope="_actionscope_5"><div class="container u-maxWidth740"><div class="responsesStreamWrapper u-maxWidth640 js-responsesStreamWrapper"><div class="container u-maxWidth640 responsesStream-title u-paddingTop15"><div class="row"><header class="heading u-clearfix"><div class="u-clearfix"><div class="heading-content u-floatLeft"><span class="heading-title heading-title--semibold">Responses</span></div></div></header></div></div><div class="container u-maxWidth640 u-marginBottom30 responsesStream-editor cardChromeless js-responsesStreamEditor"><div class="row"><div class="col u-size12of12"><div class="u-paddingTop30 u-paddingBottom30 u-paddingLeft0 u-paddingRight0 u-borderBottomLightest js-responsesLoggedOutPrompt"><button class="button button--chromeless is-touchIconBlackPulse u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--withIconAndLabel button--loggedOutPrompt" data-action="sign-in-prompt" data-redirect="https://medium.com/@luckylwk/visualising-high-dimensional-datasets-using-pca-and-t-sne-in-python-8ef87e7915b#--respond" data-action-source="logged_out_response_prompt"><span class="svgIcon svgIcon--response svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M21.27 20.058c1.89-1.826 2.754-4.17 2.754-6.674C24.024 8.21 19.67 4 14.1 4 8.53 4 4 8.21 4 13.384c0 5.175 4.53 9.385 10.1 9.385 1.007 0 2-.14 2.95-.41.285.25.592.49.918.7 1.306.87 2.716 1.31 4.19 1.31.276-.01.494-.14.6-.36a.625.625 0 0 0-.052-.65c-.61-.84-1.042-1.71-1.282-2.58a5.417 5.417 0 0 1-.154-.75zm-3.85 1.324l-.083-.28-.388.12a9.72 9.72 0 0 1-2.85.424c-4.96 0-8.99-3.706-8.99-8.262 0-4.556 4.03-8.263 8.99-8.263 4.95 0 8.77 3.71 8.77 8.27 0 2.25-.75 4.35-2.5 5.92l-.24.21v.32c0 .07 0 .19.02.37.03.29.1.6.19.92.19.7.49 1.4.89 2.08-.93-.14-1.83-.49-2.67-1.06-.34-.22-.88-.48-1.16-.74z"></path></svg></span><span class="button-label  js-buttonLabel">Write a response…</span></button></div></div></div></div><div class="container u-maxWidth640 u-marginBottom30 u-borderTopLighter u-hide js-noOtherResponses"><div class="row"><div class="col u-size12of12"><div class="u-paddingTop20 u-paddingBottom25"><div class="u-inlineBlock u-verticalAlignTop u-paddingRight10"><div class="avatar u-inline"><img src="./Visualising high-dimensional datasets using PCA and t-SNE in Python_files/1-dmbNkD5D-u45r44go_cf0g.png" class="avatar-image u-size36x36 u-xs-size32x32" alt="Unknown user"></div></div><div class="u-inlineBlock"><div class="u-lineHeight36 u-textColorNormal u-contentSerifRegular">No responses yet</div></div></div></div></div></div><div class="responsesStream js-responsesStream"></div><div class="container u-maxWidth640 js-showOtherResponses"><div class="row"><button class="button button--primary button--withChrome u-accentColor--buttonNormal responsesStream-showOtherResponses cardChromeless u-sizeFullWidth" data-action="show-other-responses">Show all responses</button></div></div><div class="responsesStream js-responsesStreamOther"></div></div></div></div><div class="supplementalPostContent js-readNext"></div><div class="supplementalPostContent js-heroPromo"></div></footer></article></main><div class="u-marginAuto u-maxWidth1000"><div class="js-postShareWidget u-foreground u-sm-hide u-fixed u-transition--fadeIn300" data-scroll="fixed" style="top: 150px;"><ul><li class="u-uiTextSemibold u-textAlignCenter u-textColorNormal u-fontSize12 u-textUppercase">Share</li><li class="u-textAlignCenter"><div class="js-actionRecommend" data-post-id="8ef87e7915b" data-is-icon-29px="true" data-is-vertical="true" data-has-recommend-list="true" data-source="post_share_widget"><button class="button button--primary button--large button--chromeless is-touchIconFadeInPulse u-accentColor--buttonNormal button--withIcon button--withSvgIcon u-accentColor--iconLight js-actionRecommendButton" title="Recommend to share this article with your followers and let the author know you liked it" aria-label="Recommend to share this article with your followers and let the author know you liked it" data-action="sign-in-prompt" data-sign-in-action="upvote" data-requires-token="true" data-redirect="https://medium.com/_/vote/p/8ef87e7915b" data-action-source="post_share_widget"><span class="button-defaultState"><span class="svgIcon svgIcon--heart svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M16.215 23.716c-.348.288-.984.826-1.376 1.158a.526.526 0 0 1-.68 0c-.36-.307-.92-.78-1.22-1.03C9.22 20.734 3 15.527 3 10.734 3 7.02 5.916 4 9.5 4c1.948 0 3.77.898 5 2.434C15.73 4.898 17.552 4 19.5 4c3.584 0 6.5 3.02 6.5 6.734 0 4.9-6.125 9.96-9.785 12.982zM19.5 5.2c-1.774 0-3.423.923-4.41 2.468a.699.699 0 0 1-.59.323.706.706 0 0 1-.59-.32c-.988-1.54-2.637-2.47-4.41-2.47-2.922 0-5.3 2.49-5.3 5.54 0 4.23 6.19 9.41 9.517 12.19.217.18.566.48.783.66l.952-.79c3.496-2.88 9.348-7.72 9.348-12.05 0-3.05-2.378-5.53-5.3-5.53z"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--heartFilled svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M19.5 4c-1.948 0-3.77.898-5 2.434C13.27 4.898 11.448 4 9.5 4 5.916 4 3 7.02 3 10.734c0 4.793 6.227 10 9.95 13.11.296.25.853.723 1.212 1.03.196.166.48.166.677 0 .39-.332 1.02-.87 1.37-1.158 3.66-3.022 9.79-8.08 9.79-12.982C26 7.02 23.08 4 19.5 4z" fill-rule="evenodd"></path></svg></span></span></button><button class="button button--chromeless u-baseColor--buttonNormal  u-block u-marginAuto u-marginTopNegative5" data-action="show-recommends" data-action-value="8ef87e7915b">6</button></div></li><li class="u-textAlignCenter"><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon" title="Share on Twitter" aria-label="Share on Twitter" data-action="share-on-twitter" data-action-source="post_share_widget"><span class="svgIcon svgIcon--twitter svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M21.967 11.8c.018 5.93-4.607 11.18-11.177 11.18-2.172 0-4.25-.62-6.047-1.76l-.268.422-.038.5.186.013.168.012c.3.02.44.032.6.046 2.06-.026 3.95-.686 5.49-1.86l1.12-.85-1.4-.048c-1.57-.055-2.92-1.08-3.36-2.51l-.48.146-.05.5c.22.03.48.05.75.08.48-.02.87-.07 1.25-.15l2.33-.49-2.32-.49c-1.68-.35-2.91-1.83-2.91-3.55 0-.05 0-.01-.01.03l-.49-.1-.25.44c.63.36 1.35.57 2.07.58l1.7.04L7.4 13c-.978-.662-1.59-1.79-1.618-3.047a4.08 4.08 0 0 1 .524-1.8l-.825.07a12.188 12.188 0 0 0 8.81 4.515l.59.033-.06-.59v-.02c-.05-.43-.06-.63-.06-.87a3.617 3.617 0 0 1 6.27-2.45l.2.21.28-.06c1.01-.22 1.94-.59 2.73-1.09l-.75-.56c-.1.36-.04.89.12 1.36.23.68.58 1.13 1.17.85l-.21-.45-.42-.27c-.52.8-1.17 1.48-1.92 2L22 11l.016.28c.013.2.014.35 0 .52v.04zm.998.038c.018-.22.017-.417 0-.66l-.498.034.284.41a8.183 8.183 0 0 0 2.2-2.267l.97-1.48-1.6.755c.17-.08.3-.02.34.03a.914.914 0 0 1-.13-.292c-.1-.297-.13-.64-.1-.766l.36-1.254-1.1.695c-.69.438-1.51.764-2.41.963l.48.15a4.574 4.574 0 0 0-3.38-1.484 4.616 4.616 0 0 0-4.61 4.613c0 .29.02.51.08.984l.01.02.5-.06.03-.5c-3.17-.18-6.1-1.7-8.08-4.15l-.48-.56-.36.64c-.39.69-.62 1.48-.65 2.28.04 1.61.81 3.04 2.06 3.88l.3-.92c-.55-.02-1.11-.17-1.6-.45l-.59-.34-.14.67c-.02.08-.02.16 0 .24-.01 2.12 1.55 4.01 3.69 4.46l.1-.49-.1-.49c-.33.07-.67.12-1.03.14-.18-.02-.43-.05-.64-.07l-.76-.09.23.73c.57 1.84 2.29 3.14 4.28 3.21l-.28-.89a8.252 8.252 0 0 1-4.85 1.66c-.12-.01-.26-.02-.56-.05l-.17-.01-.18-.01L2.53 21l1.694 1.07a12.233 12.233 0 0 0 6.58 1.917c7.156 0 12.2-5.73 12.18-12.18l-.002.04z"></path></svg></span></button></li><li class="u-textAlignCenter"><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon" title="Share on Facebook" aria-label="Share on Facebook" data-action="share-on-facebook" data-action-source="post_share_widget"><span class="svgIcon svgIcon--facebook svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M16.39 23.61v-5.808h1.846a.55.55 0 0 0 .546-.48l.36-2.797a.551.551 0 0 0-.547-.62H16.39V12.67c0-.67.12-.813.828-.813h1.474a.55.55 0 0 0 .55-.55V8.803a.55.55 0 0 0-.477-.545c-.436-.06-1.36-.116-2.22-.116-2.5 0-4.13 1.62-4.13 4.248v1.513H10.56a.551.551 0 0 0-.55.55v2.797c0 .304.248.55.55.55h1.855v5.76c-4.172-.96-7.215-4.7-7.215-9.1 0-5.17 4.17-9.36 9.31-9.36 5.14 0 9.31 4.19 9.31 9.36 0 4.48-3.155 8.27-7.43 9.15M14.51 4C8.76 4 4.1 8.684 4.1 14.46c0 5.162 3.75 9.523 8.778 10.32a.55.55 0 0 0 .637-.543v-6.985a.551.551 0 0 0-.55-.55H11.11v-1.697h1.855a.55.55 0 0 0 .55-.55v-2.063c0-2.02 1.136-3.148 3.03-3.148.567 0 1.156.027 1.597.06v1.453h-.924c-1.363 0-1.93.675-1.93 1.912v1.78c0 .3.247.55.55.55h2.132l-.218 1.69H15.84c-.305 0-.55.24-.55.55v7.02c0 .33.293.59.623.54 5.135-.7 9.007-5.11 9.007-10.36C24.92 8.68 20.26 4 14.51 4"></path></svg></span></button></li><li class="u-textAlignCenter"><button class="button button--large button--dark button--chromeless is-touchIconFadeInPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="sign-in-prompt" data-sign-in-action="add-to-bookmarks" data-requires-token="true" data-redirect="https://medium.com/_/bookmark/p/8ef87e7915b"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M19.385 4h-9.77A2.623 2.623 0 0 0 7 6.615V23.01a1.022 1.022 0 0 0 1.595.847l5.905-4.004 5.905 4.004A1.022 1.022 0 0 0 22 23.011V6.62A2.625 2.625 0 0 0 19.385 4zM21 23l-5.91-3.955-.148-.107a.751.751 0 0 0-.884 0l-.147.107L8 23V6.615C8 5.725 8.725 5 9.615 5h9.77C20.275 5 21 5.725 21 6.615V23z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M19.385 4h-9.77A2.623 2.623 0 0 0 7 6.615V23.01a1.022 1.022 0 0 0 1.595.847l5.905-4.004 5.905 4.004A1.022 1.022 0 0 0 22 23.011V6.62A2.625 2.625 0 0 0 19.385 4z" fill-rule="evenodd"></path></svg></span></span></button></li></ul></div></div><div class="u-fixed u-bottom0 u-sizeFullWidth u-backgroundWhite u-boxShadowTop u-borderBox u-paddingTop10 u-paddingBottom10 u-zIndexMetabar u-xs-paddingLeft10 u-xs-paddingRight10 js-stickyFooter"><div class="u-maxWidth700 u-marginAuto u-flexCenter"><div class="u-fontSize16 u-flex1 u-flexCenter"><div class="u-flex0 u-inlineBlock u-paddingRight20 u-xs-paddingRight10"><a class="link avatar u-inline u-baseColor--link" href="https://medium.com/@luckylwk" data-action="show-user-card" data-action-value="c85c6404c0f9" data-action-type="hover" data-user-id="c85c6404c0f9" dir="auto"><img src="./Visualising high-dimensional datasets using PCA and t-SNE in Python_files/0-E-t7oTrRvLnQ3qky(2).jpeg" class="avatar-image avatar-image--smaller" alt="Go to the profile of Luuk Derksen"></a></div><div class="u-flex1 u-inlineBlock"><div class="u-xs-hide">Never miss a story from<strong> Luuk Derksen</strong>, when you sign up for Medium. <a class="link link--accent u-accentColor--textNormal u-accentColor--textDarken u-baseColor--link" href="https://medium.com/@Medium/personalize-your-medium-experience-with-users-publications-tags-26a41ab1ee0c#.hx4zuv3mg" data-action-source="sticky_footer">Learn more</a></div><div class="u-xs-show">Never miss a story from<strong> Luuk Derksen</strong></div></div></div><div class="u-marginLeft50 u-xs-marginAuto"><span class="followState js-followState buttonSet-inner" data-user-id="c85c6404c0f9"><button class="button u-noUserSelect button--withChrome u-baseColor--buttonNormal button--withHover button--unblock js-unblockButton u-uiTextSemibold u-textUppercase u-fontSize12" data-action="sign-in-prompt" data-sign-in-action="toggle-block-user" data-requires-token="true" data-action-source="sticky_footer"><span class="button-label  button-defaultState">Blocked</span><span class="button-label button-hoverState">Unblock</span></button><button class="button button--primary is-active u-noUserSelect button--withChrome u-accentColor--buttonNormal button--follow js-followButton u-uiTextSemibold u-textUppercase u-fontSize12" data-action="sign-in-prompt" data-sign-in-action="toggle-subscribe-user" data-requires-token="true" data-redirect="https://medium.com/_/subscribe/user/c85c6404c0f9" data-action-source="sticky_footer_follow"><span class="button-label  button-defaultState js-buttonLabel">Follow</span><span class="button-label button-activeState">Get updates</span></button></span></div></div></div><div class="highlightMenu" data-action-scope="_actionscope_3"><div class="highlightMenu-inner"><div class="buttonSet"><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--highlightMenu u-accentColor--highlightStrong js-highlightMenuQuoteButton" data-action="sign-in-prompt" data-sign-in-action="quote" data-requires-token="true" data-redirect-type="quote" data-action-source="quote_menu"><span class="svgIcon svgIcon--highlighter svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M13.7 15.964l5.204-9.387-4.726-2.62-5.204 9.387 4.726 2.62zm-.493.885l-1.313 2.37-1.252.54-.702 1.263-3.796-.865 1.228-2.213-.202-1.35 1.314-2.37 4.722 2.616z" fill-rule="evenodd"></path></svg></span></button><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--highlightMenu " data-action="sign-in-prompt" data-sign-in-action="quote-respond" data-action-source="quote_menu"><span class="svgIcon svgIcon--responseFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M19.074 21.117c-1.244 0-2.432-.37-3.532-1.096a7.792 7.792 0 0 1-.703-.52c-.77.21-1.57.32-2.38.32-4.67 0-8.46-3.5-8.46-7.8C4 7.7 7.79 4.2 12.46 4.2c4.662 0 8.457 3.5 8.457 7.803 0 2.058-.85 3.984-2.403 5.448.023.17.06.35.118.55.192.69.537 1.38 1.026 2.04.15.21.172.48.058.7a.686.686 0 0 1-.613.38h-.03z" fill-rule="evenodd"></path></svg></span></button><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--highlightMenu " data-action="twitter" data-action-source="quote_menu"><span class="svgIcon svgIcon--twitterFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M21.725 5.338c-.744.47-1.605.804-2.513 1.006a3.978 3.978 0 0 0-2.942-1.293c-2.22 0-4.02 1.81-4.02 4.02 0 .32.034.63.07.94-3.31-.18-6.27-1.78-8.255-4.23a4.544 4.544 0 0 0-.574 2.01c.04 1.43.74 2.66 1.8 3.38-.63-.01-1.25-.19-1.79-.5v.08c0 1.93 1.38 3.56 3.23 3.95-.34.07-.7.12-1.07.14-.25-.02-.5-.04-.72-.07.49 1.58 1.97 2.74 3.74 2.8a8.49 8.49 0 0 1-5.02 1.72c-.3-.03-.62-.04-.93-.07A11.447 11.447 0 0 0 8.88 21c7.386 0 11.43-6.13 11.414-11.414.015-.21.01-.38 0-.578a7.604 7.604 0 0 0 2.01-2.08 7.27 7.27 0 0 1-2.297.645 3.856 3.856 0 0 0 1.72-2.23"></path></svg></span></button><div class="buttonSet-separator"></div><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--highlightMenu " data-action="sign-in-prompt" data-sign-in-action="highlight" data-action-source="quote_menu"><span class="svgIcon svgIcon--privatenoteFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M17.662 4.552H7.346A4.36 4.36 0 0 0 3 8.898v5.685c0 2.168 1.614 3.962 3.697 4.28v2.77c0 .303.35.476.59.29l3.904-2.994h6.48c2.39 0 4.35-1.96 4.35-4.35V8.9c0-2.39-1.95-4.346-4.34-4.346zM16 14.31a.99.99 0 0 1-1.003.99h-4.994C9.45 15.3 9 14.85 9 14.31v-3.02a.99.99 0 0 1 1-.99v-.782a2.5 2.5 0 0 1 2.5-2.51c1.38 0 2.5 1.13 2.5 2.51v.782c.552.002 1 .452 1 .99v3.02z"></path><path d="M14 9.81c0-.832-.674-1.68-1.5-1.68-.833 0-1.5.84-1.5 1.68v.49h3v-.49z"></path></g></svg></span></button></div></div><div class="highlightMenu-arrowClip"><span class="highlightMenu-arrow"></span></div></div></div></div></div><div class="loadingBar"></div><script>// <![CDATA[
window["obvInit"] = function (opt_embedded) {window["obvInit"]["embedded"] = opt_embedded; window["obvInit"]["ready"] = true;}
// ]]></script><script>// <![CDATA[
var GLOBALS = {"audioUrl":"https://d1fcbxp97j4nb2.cloudfront.net","baseUrl":"https://medium.com","buildLabel":"29260-b408c8f","currentUser":{"userId":"lo_edd7c3f6282a","isVerified":false,"subscriberEmail":""},"currentUserHasUnverifiedEmail":false,"isAuthenticated":false,"isCurrentUserVerified":false,"language":"en-us","mediumTwitterScreenName":"medium","miroUrl":"https://cdn-images-1.medium.com","moduleUrls":{"base":"https://cdn-static-1.medium.com/_/fp/gen-js/main-base.bundle.A5KlKKA5nEB8AUnr4FeAeg.js","notes":"https://cdn-static-1.medium.com/_/fp/gen-js/main-notes.bundle.ASVjQiM4Xw0FiUDq8p2xTA.js","payments":"https://cdn-static-1.medium.com/_/fp/gen-js/main-payments.bundle.Tuee8iXe-zxUs7uvdBRzWQ.js","posters":"https://cdn-static-1.medium.com/_/fp/gen-js/main-posters.bundle.hBbTiQMpKYtZLIkr_2jHFA.js","common-async":"https://cdn-static-1.medium.com/_/fp/gen-js/main-common-async.bundle.mISNxGeGc9Ms63X-F7Hi1A.js","stats":"https://cdn-static-1.medium.com/_/fp/gen-js/main-stats.bundle.tGdzscuYWNA2fwlryZswLg.js","home-screens":"https://cdn-static-1.medium.com/_/fp/gen-js/main-home-screens.bundle.dC-Ii_nvV-_Uj7wTBpSsJA.js","misc-screens":"https://cdn-static-1.medium.com/_/fp/gen-js/main-misc-screens.bundle.mm0jWXSMmZ5-55RSX7jWLA.js"},"previewConfig":{"weightThreshold":1,"weightImageParagraph":0.51,"weightIframeParagraph":0.8,"weightTextParagraph":0.08,"weightEmptyParagraph":0,"weightP":0.003,"weightH":0.005,"weightBq":0.003,"minPTextLength":60,"truncateBoundaryChars":20,"detectTitle":true,"detectTitleLevThreshold":0.15},"productName":"Medium","supportsEdit":true,"termsUrl":"//medium.com/policy/9db0094a1e0f","textshotHost":"textshot.medium.com","transactionId":"1496324711080:68dd4bb114c7","useragent":{"browser":"chrome","family":"chrome","os":"","version":58,"supportsDesktopEdit":true,"supportsInteract":true,"supportsView":true,"isMobile":false,"isTablet":false,"isNative":false,"supportsFileAPI":true,"isTier1":true,"clientVersion":"","unknownParagraphsBad":false,"clientChannel":"","supportsRealScrollEvents":true,"supportsVhUnits":true,"ruinsViewportSections":false,"supportsHtml5Video":true,"supportsMagicUnderlines":true,"isWebView":false,"isFacebookWebView":false,"supportsProgressiveMedia":true,"supportsPromotedPosts":true,"isBot":false,"isNativeIphone":false,"supportsCssVariables":true,"supportsVideoSections":false,"supportsScrollableMetabar":true},"variants":{"allow_access":true,"allow_signup":true,"allow_test_auth":"disallow","signin_services":"twitter,facebook,google,email,google-fastidv","signup_services":"twitter,facebook,google,email,google-fastidv","android_rating_prompt_recommend_threshold":5,"google_sign_in_android":true,"enable_onboarding":true,"ios_custom_miro_url":"https://cdn-images-1.medium.com","reengagement_notification_duration":3,"enable_adsnative_integration":true,"browsable_stream_config_bucket":"curated-topics","ios_small_post_preview_truncation_length":5.5,"ios_large_post_preview_truncation_length":5.5,"disable_ios_catalog_badging":true,"enable_series_creation":true,"enable_your_series_pages":true,"enable_productionized_series":true,"enable_dedicated_series_tab_api_ios":true,"enable_clap_milestone_notifications":true,"enable_series_stats_page":true,"enable_prepublish_share_settings":true,"enable_direct_auth_connect":true,"enable_post_import":true,"enable_sponsored_post_labelling":true,"enable_logged_in_follow_on_collection_post":true,"promoted_story_placement_locations":"POST_PAGE_FOOTER","enable_chunky_home_page_compact":true,"show_topics":true,"enable_search_collection_by_tag_recency_filter":true,"search_collection_by_tag_filter_min_votes":10,"enable_sms_app_promo":true,"enable_export_members":true,"enable_series_card_background_creation":true,"enable_loyal_writers_onboarding":true,"enable_onboarding_hybrid_users":true,"enable_ios_onboarding_notifications":true,"can_subscribe":true,"enable_partner_program_landing_page":true,"available_membership_plans":"60e220181034","enable_hide_broken_links":true,"enable_pay_for_custom_domain":true,"enable_promos_in_placement":true,"double_write_post_from_followed_tag_items":true,"enable_sms":true,"enable_series_in_user_profiles":true,"enable_new_logged_out_bento_operation":true,"enable_featured_image_selector":true,"enable_user_social_suggestions":true,"enable_web_audio":true,"enable_people_and_pubs_from_ranked_feed":true,"enable_people_and_pubs_standalone_page_from_ranked_feed":true,"enable_audio_topic":true,"is_not_medium_subscriber":true,"subs_landing_copy_experiments":"long","enable_jump_back_in_chp_item":true,"logged_out_homepage_promo":"content","enable_free_trial_reminders":true},"xsrfToken":"","iosAppId":"828256236","supportEmail":"yourfriends@medium.com","teamName":"Team Medium","fp":{"/icons/favicon.svg":"https://cdn-static-1.medium.com/_/fp/icons/favicon.KjTfUJo7yJH_fCoUzzH3cg.svg","/icons/favicon-dev-editor.ico":"https://cdn-static-1.medium.com/_/fp/icons/favicon-dev-editor.YKKRxBO8EMvIqhyCwIiJeQ.ico","/icons/favicon-hatch-editor.ico":"https://cdn-static-1.medium.com/_/fp/icons/favicon-hatch-editor.BuEyHIqlyh2s_XEk4Rl32Q.ico","/icons/favicon-medium-editor.ico":"https://cdn-static-1.medium.com/_/fp/icons/favicon-medium-editor.PiakrZWB7Yb80quUVQWM6g.ico"},"authBaseUrl":"https://medium.com","imageUploadSizeMb":25,"isAuthDomainRequest":true,"algoliaApiEndpoint":"https://MQ57UUUQZ2-dsn.algolia.net","algoliaAppId":"MQ57UUUQZ2","algoliaSearchOnlyApiKey":"394474ced050e3911ae2249ecc774921","iosAppStoreUrl":"https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8","iosAppLinkBaseUrl":"medium:","algoliaIndexPrefix":"medium_","androidPlayStoreUrl":"https://play.google.com/store/apps/details?id=com.medium.reader","googleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","androidPackage":"com.medium.reader","androidPlayStoreMarketScheme":"market://details?id=com.medium.reader","googleAuthUri":"https://accounts.google.com/o/oauth2/auth","androidScheme":"medium","layoutData":{"useDynamicScripts":false,"googleAnalyticsTrackingCode":"UA-24232453-2","jsShivUrl":"https://cdn-static-1.medium.com/_/fp/js/shiv.RI2ePTZ5gFmMgLzG5bEVAA.js","useDynamicCss":false,"faviconUrl":"https://cdn-static-1.medium.com/_/fp/icons/favicon-medium.TAS6uQ-Y7kcKgi0xjcYHXw.ico","faviconImageId":"1*W0nmth_X8nFKjn6BZ388UQ.png","fontSets":[{"id":1,"url":"https://cdn-static-1.medium.com/_/fp/css/fonts-base.by5Oi_VbnwEIvhnWIsuUjA.css"},{"id":4,"url":"https://cdn-static-1.medium.com/_/fp/css/fonts-lazy-base.g08Jj5TZPAiuPWj5YNUsSg.css"},{"id":6,"url":"https://cdn-static-1.medium.com/_/fp/css/fonts-latin-base.141WxxXgxGxNcfeza73H7Q.css"},{"id":7,"url":"https://cdn-static-1.medium.com/_/fp/css/fonts-lazy-latin-base.jMU532QDmysQMOINr-cr2A.css"}],"editorFaviconUrl":"https://cdn-static-1.medium.com/_/fp/icons/favicon-medium-editor.PiakrZWB7Yb80quUVQWM6g.ico"},"authBaseUrlRev":"moc.muidem//:sptth","isDnt":false,"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","archiveUploadSizeMb":100,"paymentData":{"currencies":{"1":{"label":"US Dollar","external":"usd"}},"countries":{"1":{"label":"United States of America","external":"US"}},"accountTypes":{"1":{"label":"Individual","external":"individual"},"2":{"label":"Company","external":"company"}}},"previewConfig2":{"weightThreshold":1,"weightImageParagraph":0.05,"raiseImage":true,"enforceHeaderHierarchy":true,"isImageInsetRight":true},"isAmp":false,"iosScheme":"medium","isSwBoot":false,"lightstep":{"accessToken":"ce5be895bef60919541332990ac9fef2","carrier":"{\"ot-tracer-spanid\":\"2272fb296736a2b8\",\"ot-tracer-traceid\":\"2f35d7775d40bab8\",\"ot-tracer-sampled\":\"true\"}","host":"collector-medium.lightstep.com"},"facebook":{"key":"542599432471018","namespace":"medium-com","scope":{"default":["public_profile","email","user_friends"],"connect":["public_profile","email","user_friends"],"login":["public_profile","email","user_friends"],"share":["public_profile","email","user_friends","publish_actions"]}},"mailingListArchiveUploadSizeMb":2,"availableMembershipPlans":["60e220181034"],"editorsPicksTopicId":"3985d2a191c5","popularOnMediumTopicId":"9d34e48ecf94","memberContentTopicId":"13d7efd82fb2","audioContentTopicId":"3792abbd134","isDoNotAuth":false,"goldfinchUrl":"https://goldfinch.medium.com","buggle":{"url":"https://buggle.medium.com","videoUrl":"https://cdn-videos-1.medium.com","audioUrl":"https://cdn-audio-1.medium.com"}}
// ]]></script><script charset="UTF-8" src="./Visualising high-dimensional datasets using PCA and t-SNE in Python_files/main-base.bundle.A5KlKKA5nEB8AUnr4FeAeg.js" async=""></script><script>// <![CDATA[
window["obvInit"]({"value":{"id":"8ef87e7915b","versionId":"4d3e020dbbec","creatorId":"c85c6404c0f9","creator":{"userId":"c85c6404c0f9","name":"Luuk Derksen","username":"luckylwk","createdAt":1465163139954,"lastPostCreatedAt":1491475524757,"imageId":"0*E-t7oTrRvLnQ3qky.jpeg","backgroundImageId":"","bio":"Data (Scientist) junky. All views my own. | PGP: http://goo.gl/CMdQR7","twitterScreenName":"luckylwk","socialStats":{"userId":"c85c6404c0f9","usersFollowedCount":122,"usersFollowedByCount":55,"type":"SocialStats"},"social":{"userId":"lo_edd7c3f6282a","targetUserId":"c85c6404c0f9","type":"Social"},"facebookAccountId":"","allowNotes":1,"type":"User"},"homeCollectionId":"","title":"Visualising high-dimensional datasets using PCA and t-SNE in Python","detectedLanguage":"en","latestVersion":"4d3e020dbbec","latestPublishedVersion":"4d3e020dbbec","hasUnpublishedEdits":false,"latestRev":279,"createdAt":1477742263416,"updatedAt":1496235239506,"acceptedAt":0,"firstPublishedAt":1477743080007,"latestPublishedAt":1477743080007,"vote":false,"experimentalCss":"","displayAuthor":"","content":{"subtitle":"The first step around any data related challenge is to start by exploring the data itself. This could be by looking at, for example, the…","bodyModel":{"paragraphs":[{"name":"978f","type":3,"text":"Visualising high-dimensional datasets using PCA and t-SNE in Python","markups":[]},{"name":"6a62","type":1,"text":"The first step around any data related challenge is to start by exploring the data itself. This could be by looking at, for example, the distributions of certain variables or looking at potential correlations between variables.","markups":[]},{"name":"1414","type":1,"text":"The problem nowadays is that most datasets have a large number of variables. In other words, they have a high number of dimensions along which the data is distributed. Visually exploring the data can then become challenging and most of the time even practically impossible to do manually. However, such visual exploration is incredibly important in any data-related problem. Therefore it is key to understand how to visualise high-dimensional datasets. This can be achieved using techniques known as dimensionality reduction. This post will focus on two techniques that will allow us to do this: PCA and t-SNE.","markups":[]},{"name":"a55e","type":1,"text":"More about that later. Lets first get some (high-dimensional) data to work with.","markups":[]},{"name":"f858","type":3,"text":"MNIST dataset","markups":[]},{"name":"2837","type":1,"text":"We will use the MNIST-dataset in this write-up. There is no need to download the dataset manually as we can grab it through using Scikit Learn.","markups":[{"type":3,"start":16,"end":29,"href":"http://yann.lecun.com/exdb/mnist/","title":"","rel":"","anchorType":0},{"type":3,"start":130,"end":142,"href":"http://scikit-learn.org/","title":"","rel":"","anchorType":0}]},{"name":"3fee","type":8,"text":"import numpy as np\nfrom sklearn.datasets import fetch_mldata","markups":[{"type":10,"start":0,"end":60},{"type":1,"start":0,"end":6},{"type":1,"start":13,"end":15},{"type":1,"start":19,"end":23},{"type":1,"start":41,"end":47}]},{"name":"a9b4","type":8,"text":"\nmnist = fetch_mldata(\"MNIST original\")\nX = mnist.data / 255.0\ny = mnist.target\n","markups":[{"type":10,"start":0,"end":80},{"type":1,"start":7,"end":8},{"type":1,"start":42,"end":43},{"type":1,"start":49,"end":50},{"type":1,"start":55,"end":56},{"type":1,"start":65,"end":66},{"type":1,"start":72,"end":73}]},{"name":"6f98","type":8,"text":"print X.shape, y.shape","markups":[{"type":10,"start":0,"end":22},{"type":1,"start":0,"end":5},{"type":1,"start":7,"end":8},{"type":1,"start":16,"end":17}]},{"name":"54a1","type":8,"text":"\n[out] (70000, 784) (70000,)","markups":[]},{"name":"c3bf","type":1,"text":"We are going to convert the matrix and vector to a Pandas DataFrame. This is very similar to the DataFrames used in R and will make it easier for us to plot it later on.","markups":[]},{"name":"aebb","type":8,"text":"import pandas as pd","markups":[{"type":10,"start":0,"end":19},{"type":1,"start":0,"end":6},{"type":1,"start":14,"end":16}]},{"name":"2ddc","type":8,"text":"\nfeat_cols = [ 'pixel'+str(i) for i in range(X.shape[1]) ]\n\ndf = pd.DataFrame(X,columns=feat_cols)\ndf['label'] = y\ndf['label'] = df['label'].apply(lambda i: str(i))\n\nX, y = None, None","markups":[{"type":10,"start":0,"end":183},{"type":1,"start":11,"end":12},{"type":1,"start":22,"end":23},{"type":1,"start":30,"end":33},{"type":1,"start":36,"end":38},{"type":1,"start":46,"end":47},{"type":1,"start":63,"end":64},{"type":1,"start":67,"end":68},{"type":1,"start":87,"end":88},{"type":1,"start":111,"end":112},{"type":1,"start":127,"end":128},{"type":1,"start":140,"end":141},{"type":1,"start":147,"end":153},{"type":1,"start":171,"end":172}]},{"name":"9e21","type":8,"text":"\nprint 'Size of the dataframe: {}'.format(df.shape)","markups":[{"type":10,"start":0,"end":51},{"type":1,"start":1,"end":6},{"type":1,"start":34,"end":35},{"type":1,"start":44,"end":45}]},{"name":"d8e5","type":8,"text":"\n[out] Size of the dataframe: (70000, 785)","markups":[]},{"name":"07a5","type":1,"text":"Because we dont want to be using 70,000 digits in some calculations we’ll take a random subset of the digits. The randomisation is important as the dataset is sorted by its label (i.e., the first seven thousand or so are zeros, etc.). To ensure randomisation we’ll create a random permutation of the number 0 to 69,999 which allows us later to select the first five or ten thousand for our calculations and visualisations.","markups":[]},{"name":"ac34","type":8,"text":"rndperm = np.random.permutation(df.shape[0])","markups":[{"type":10,"start":0,"end":44},{"type":1,"start":8,"end":9},{"type":1,"start":12,"end":13},{"type":1,"start":19,"end":20},{"type":1,"start":34,"end":35}]},{"name":"b155","type":1,"text":"We now have our dataframe and our randomisation vector. Lets first check what these numbers actually look like. To do this we’ll generate 30 plots of randomly selected images.","markups":[]},{"name":"999c","type":8,"text":"%matplotlib inline\nimport matplotlib.pyplot as plt","markups":[{"type":10,"start":0,"end":50},{"type":1,"start":0,"end":1},{"type":1,"start":19,"end":25},{"type":1,"start":44,"end":46}]},{"name":"12ea","type":8,"text":"\n# Plot the graph\nplt.gray()\nfig = plt.figure( figsize=(16,7) )\nfor i in range(0,30):\n    ax = fig.add_subplot(3,10,i+1, title='Digit: ' + str(df.loc[rndperm[i],'label']) )\n    ax.matshow(df.loc[rndperm[i],feat_cols].values.reshape((28,28)).astype(float))","markups":[{"type":10,"start":0,"end":255},{"type":1,"start":21,"end":22},{"type":1,"start":33,"end":34},{"type":1,"start":38,"end":39},{"type":1,"start":54,"end":55},{"type":1,"start":64,"end":67},{"type":1,"start":70,"end":72},{"type":1,"start":93,"end":94},{"type":1,"start":98,"end":99},{"type":1,"start":117,"end":118},{"type":1,"start":126,"end":127},{"type":1,"start":137,"end":138},{"type":1,"start":145,"end":146},{"type":1,"start":179,"end":180},{"type":1,"start":190,"end":191},{"type":1,"start":216,"end":217},{"type":1,"start":223,"end":224},{"type":1,"start":240,"end":241},{"type":2,"start":1,"end":17}]},{"name":"b535","type":8,"text":"plt.show()","markups":[{"type":10,"start":0,"end":10},{"type":1,"start":3,"end":4}]},{"name":"2f08","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*aA35Y_xIyqNyeSYqIAifQQ.png","originalWidth":1868,"originalHeight":788}},{"name":"a173","type":1,"text":"Now we can start thinking about how we can actually distinguish the zeros from the ones and two’s and so on. If you were, for example, a post office such an algorithm could help you read and sort the handwritten envelopes using a machine instead of having humans do that. Obviously nowadays we have very advanced methods to do this, but this dataset still provides a very good testing ground for seeing how specific methods for dimensionality reduction work and how well they work.","markups":[]},{"name":"c86c","type":1,"text":"The images are all essentially 28-by-28 pixel images and therefore have a total of 784 ‘dimensions’, each holding the value of one specific pixel.","markups":[]},{"name":"ed6e","type":1,"text":"What we can do is reduce the number of dimensions drastically whilst trying to retain as much of the ‘variation’ in the information as possible. This is where we get to dimensionality reduction. Lets first take a look at something known as Principal Component Analysis.","markups":[{"type":1,"start":240,"end":268}]},{"name":"49fa","type":3,"text":"Dimensionality reduction using PCA","markups":[]},{"name":"8b31","type":1,"text":"PCA is a technique for reducing the number of dimensions in a dataset whilst retaining most information. It is using the correlation between some dimensions and tries to provide a minimum number of variables that keeps the maximum amount of variation or information about how the original data is distributed. It does not do this using guesswork but using hard mathematics and it uses something known as the eigenvalues and eigenvectors of the data-matrix. These eigenvectors of the covariance matrix have the property that they point along the major directions of variation in the data. These are the directions of maximum variation in a dataset.","markups":[]},{"name":"604a","type":1,"text":"I am not going to get into the actual derivation and calculation of the principal components — if you want to get into the mathematics see this great page — instead we’ll use the Scikit-Learn implementation of PCA.","markups":[{"type":3,"start":139,"end":143,"href":"https://www.math.hmc.edu/calculus/tutorials/eigenstuff/","title":"","rel":"","anchorType":0},{"type":3,"start":179,"end":213,"href":"http://scikit-learn.org/stable/modules/generated/sklearn.decomposition.PCA.html","title":"","rel":"","anchorType":0}]},{"name":"9ae8","type":1,"text":"Since we as humans like our two- and three-dimensional plots lets start with that and generate, from the original 784 dimensions, the first three principal components. And we’ll also see how much of the variation in the total dataset they actually account for.","markups":[]},{"name":"1e2c","type":8,"text":"from sklearn.decomposition import PCA","markups":[{"type":10,"start":0,"end":37},{"type":1,"start":0,"end":4},{"type":1,"start":27,"end":33}]},{"name":"4cf5","type":8,"text":"\npca = PCA(n_components=3)\npca_result = pca.fit_transform(df[feat_cols].values)\n\ndf['pca-one'] = pca_result[:,0]\ndf['pca-two'] = pca_result[:,1] \ndf['pca-three'] = pca_result[:,2]","markups":[{"type":10,"start":0,"end":179},{"type":1,"start":5,"end":6},{"type":1,"start":23,"end":24},{"type":1,"start":38,"end":39},{"type":1,"start":43,"end":44},{"type":1,"start":71,"end":72},{"type":1,"start":95,"end":96},{"type":1,"start":127,"end":128},{"type":1,"start":162,"end":163}]},{"name":"61ce","type":8,"text":"\nprint 'Explained variation per principal component: {}'.format(pca.explained_variance_ratio_)","markups":[{"type":10,"start":0,"end":94},{"type":1,"start":1,"end":6},{"type":1,"start":56,"end":57},{"type":1,"start":67,"end":68}]},{"name":"afd7","type":8,"text":"[out] Explained variation per principal component: [ 0.16756229  0.0826886   0.05374424]","markups":[]},{"name":"282f","type":1,"text":"Now, given that the first two components account for about 25% of the variation in the entire dataset lets see if that is enough to visually set the different digits apart. What we can do is create a scatterplot of the first and second principal component and color each of the different types of digits with a different color. If we are lucky the same type of digits will be positioned (i.e., clustered) together in groups, which would mean that the first two principal components actually tell us a great deal about the specific types of digits.","markups":[]},{"name":"d46c","type":8,"text":"from ggplot import *","markups":[{"type":10,"start":0,"end":20},{"type":1,"start":0,"end":4},{"type":1,"start":12,"end":18},{"type":1,"start":19,"end":20}]},{"name":"a823","type":8,"text":"\nchart = ggplot( df.loc[rndperm[:3000],:], aes(x='x-pca', y='y-pca', color='label') ) \\\n        + geom_point(size=75,alpha=0.8) \\\n        + ggtitle(\"First and Second Principal Components colored by digit\")\nchart","markups":[{"type":10,"start":0,"end":211},{"type":1,"start":7,"end":8},{"type":1,"start":19,"end":20},{"type":1,"start":48,"end":49},{"type":1,"start":59,"end":60},{"type":1,"start":74,"end":75},{"type":1,"start":96,"end":97},{"type":1,"start":113,"end":114},{"type":1,"start":122,"end":123},{"type":1,"start":138,"end":139}]},{"name":"ed35","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*lA64VdZ5w6wSEdtPVUENIQ.png","originalWidth":1228,"originalHeight":1036}},{"name":"0b56","type":1,"text":"From the graph we can see the two components definitely hold some information, especially for specific digits, but clearly not enough to set all of them apart. Luckily there is another technique that we can use to reduce the number of dimensions that may prove more helpful. In the next few paragraphs we are going to take a look at that technique and explore if it gives us a better way of reducing the dimensions for visualisation. The method we will be exploring is known as t-SNE (t-Distributed Stochastic Neighbouring Entities).","markups":[]},{"name":"e911","type":3,"text":"T-Distributed Stochastic Neighbouring Entities (t-SNE)","markups":[]},{"name":"99d8","type":1,"text":"t-Distributed Stochastic Neighbor Embedding (t-SNE) is another technique for dimensionality reduction and is particularly well suited for the visualization of high-dimensional datasets. Contrary to PCA it is not a mathematical technique but a probablistic one. The original paper describes the working of t-SNE as:","markups":[{"type":3,"start":45,"end":50,"href":"http://lvdmaaten.github.io/tsne/","title":"","rel":"","anchorType":0},{"type":3,"start":265,"end":279,"href":"http://jmlr.org/papers/volume9/vandermaaten08a/vandermaaten08a.pdf","title":"","rel":"","anchorType":0}]},{"name":"ec7d","type":1,"text":"t-Distributed stochastic neighbor embedding (t-SNE) minimizes the divergence between two distributions: a distribution that measures pairwise similarities of the input objects and a distribution that measures pairwise similarities of the corresponding low-dimensional points in the embedding.","markups":[{"type":2,"start":0,"end":292}]},{"name":"486f","type":1,"text":"Essentially what this means is that it looks at the original data that is entered into the algorithm and looks at how to best represent this data using less dimensions by matching both distributions. The way it does this is computationally quite heavy and therefore there are some (serious) limitations to the use of this technique. For example one of the recommendations is that, in case of very high dimensional data, you may need to apply another dimensionality reduction technique before using t-SNE:","markups":[]},{"name":"1a41","type":8,"text":"|  It is highly recommended to use another dimensionality reduction\n |  method (e.g. PCA for dense data or TruncatedSVD for sparse data)\n |  to reduce the number of dimensions to a reasonable amount (e.g. 50)\n |  if the number of features is very high.","markups":[{"type":10,"start":0,"end":252}]},{"name":"4523","type":1,"text":"The other key drawback is that it:","markups":[]},{"name":"48bf","type":1,"text":"Since t-SNE scales quadratically in the number of objects N, its applicability is limited to data sets with only a few thousand input objects; beyond that, learning becomes too slow to be practical (and the memory requirements become too large).","markups":[{"type":2,"start":0,"end":245}]},{"name":"fa0c","type":1,"text":"We will use the Scikit-Learn Implementation of the algorithm in the remainder of this writeup.","markups":[{"type":3,"start":16,"end":43,"href":"http://scikit-learn.org/stable/modules/generated/sklearn.manifold.TSNE.html","title":"","rel":"","anchorType":0}]},{"name":"3667","type":1,"text":"Contrary to the recommendation above we will first try to run the algorithm on the actual dimensions of the data (784) and see how it does. To make sure we don’t burden our machine in terms of memory and power/time we will only use the first 7,000 samples to run the algorithm on.","markups":[]},{"name":"c47d","type":8,"text":"import time\n\nfrom sklearn.manifold import TSNE\n\nn_sne = 7000\n\ntime_start = time.time()\ntsne = TSNE(n_components=2, verbose=1, perplexity=40, n_iter=300)\ntsne_results = tsne.fit_transform(df.loc[rndperm[:n_sne],feat_cols].values)","markups":[{"type":10,"start":0,"end":228},{"type":1,"start":0,"end":6},{"type":1,"start":13,"end":17},{"type":1,"start":35,"end":41},{"type":1,"start":54,"end":55},{"type":1,"start":73,"end":74},{"type":1,"start":79,"end":80},{"type":1,"start":92,"end":93},{"type":1,"start":111,"end":112},{"type":1,"start":122,"end":123},{"type":1,"start":136,"end":137},{"type":1,"start":147,"end":148},{"type":1,"start":166,"end":167},{"type":1,"start":172,"end":173},{"type":1,"start":189,"end":190},{"type":1,"start":220,"end":221}]},{"name":"4223","type":8,"text":"\nprint 't-SNE done! Time elapsed: {} seconds'.format(time.time()-time_start)","markups":[{"type":10,"start":0,"end":76},{"type":1,"start":0,"end":6},{"type":1,"start":45,"end":46},{"type":1,"start":57,"end":58},{"type":1,"start":64,"end":65}]},{"name":"768a","type":8,"text":"[out]\n[t-SNE] Computing pairwise distances...\n[t-SNE] Computed conditional probabilities for sample 1000 / 7000\n[t-SNE] Computed conditional probabilities for sample 2000 / 7000\n[t-SNE] Computed conditional probabilities for sample 3000 / 7000\n[t-SNE] Computed conditional probabilities for sample 4000 / 7000\n[t-SNE] Computed conditional probabilities for sample 5000 / 7000\n[t-SNE] Computed conditional probabilities for sample 6000 / 7000\n[t-SNE] Computed conditional probabilities for sample 7000 / 7000\n[t-SNE] Mean sigma: 2.170716\n[t-SNE] Error after 97 iterations with early exaggeration: 17.891132\n[t-SNE] Error after 300 iterations: 2.206017\nt-SNE done! Time elapsed: 813.213096142 seconds","markups":[]},{"name":"e271","type":1,"text":"Now that we have the two resulting dimensions we can again visualise them by creating a scatter plot of the two dimensions and coloring each sample by its respective label.","markups":[]},{"name":"ce81","type":8,"text":"df_tsne = df.loc[rndperm[:n_sne],:].copy()\ndf_tsne['x-tsne'] = tsne_results[:,0]\ndf_tsne['y-tsne'] = tsne_results[:,1]\n\nchart = ggplot( df_tsne, aes(x='x-tsne', y='y-tsne', color='label') ) \\\n        + geom_point(size=70,alpha=0.1) \\\n        + ggtitle(\"tSNE dimensions colored by digit\")\nchart","markups":[{"type":10,"start":0,"end":293},{"type":1,"start":8,"end":9},{"type":1,"start":12,"end":13},{"type":1,"start":35,"end":36},{"type":1,"start":61,"end":62},{"type":1,"start":99,"end":100},{"type":1,"start":126,"end":127},{"type":1,"start":150,"end":151},{"type":1,"start":162,"end":163},{"type":1,"start":178,"end":179},{"type":1,"start":200,"end":201},{"type":1,"start":217,"end":218},{"type":1,"start":226,"end":227},{"type":1,"start":242,"end":243}]},{"name":"541f","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*9RHEN1wP2KGYKhYdiNw7qQ.png","originalWidth":1230,"originalHeight":1034}},{"name":"88da","type":1,"text":"This is already a significant improvement over the PCA visualisation we used earlier. We can see that the digits are very clearly clustered in their own little group. If we would now use a clustering algorithm to pick out the seperate clusters we could probably quite accurately assign new points to a label.","markups":[]},{"name":"6a76","type":1,"text":"We’ll now take the recommandations to heart and actually reduce the number of dimensions before feeding the data into the t-SNE algorithm. For this we’ll use PCA again. We will first create a new dataset containing the fifty dimensions generated by the PCA reduction algorithm. We can then use this dataset to perform the t-SNE on","markups":[]},{"name":"880a","type":8,"text":"pca_50 = PCA(n_components=50)\npca_result_50 = pca_50.fit_transform(df[feat_cols].values)","markups":[{"type":10,"start":0,"end":88},{"type":1,"start":7,"end":8},{"type":1,"start":25,"end":26},{"type":1,"start":44,"end":45},{"type":1,"start":52,"end":53},{"type":1,"start":80,"end":81}]},{"name":"4d4e","type":8,"text":"\nprint 'Explained variation per principal component (PCA): {}'.format(np.sum(pca_50.explained_variance_ratio_))","markups":[{"type":10,"start":0,"end":111},{"type":1,"start":1,"end":6},{"type":1,"start":62,"end":63},{"type":1,"start":72,"end":73},{"type":1,"start":83,"end":84}]},{"name":"bdde","type":8,"text":"\n[out] Explained variation per principal component (PCA): 84.6676222833%","markups":[]},{"name":"7e59","type":1,"text":"Amazingly, the first 50 components roughly hold around 85% of the total variation in the data.","markups":[]},{"name":"bd61","type":1,"text":"Now lets try and feed this data into the t-SNE algorithm. This time we’ll use 10,000 samples out of the 70,000 to make sure the algorithm does not take up too much memory and CPU. Since the code used for this is very similar to the previous t-SNE code I have moved it to the Appendix: Code section at the bottom of this post. The plot it produced is the following one:","markups":[]},{"name":"9c37","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*OvotzpNWbWE8wZht7Pw3_Q.png","originalWidth":1250,"originalHeight":1028}},{"name":"4de5","type":1,"text":"From this plot we can clearly see how all the samples are nicely spaced apart and grouped together with their respective digits. This could be an amazing starting point to then use a clustering algorithm and try to identify the clusters or to actually use these two dimensions as input to another algorithm (e.g., something like a Neural Network).","markups":[]},{"name":"dfa6","type":1,"text":"So we have explored using various dimensionality reduction techniques to visualise high-dimensional data using a two-dimensional scatter plot. We have not gone into the actual mathematics involved but instead relied on the Scikit-Learn implementations of all algorithms.","markups":[]},{"name":"1007","type":3,"text":"Appendix: Code","markups":[]},{"name":"ac9c","type":1,"text":"Code: t-SNE on PCA-reduced data","markups":[]},{"name":"d074","type":8,"text":"n_sne = 10000\n\ntime_start = time.time()\n\ntsne = TSNE(n_components=2, verbose=1, perplexity=40, n_iter=300)\ntsne_pca_results = tsne.fit_transform(pca_result_50[rndperm[:n_sne]])","markups":[{"type":10,"start":0,"end":176},{"type":1,"start":6,"end":7},{"type":1,"start":26,"end":27},{"type":1,"start":32,"end":33},{"type":1,"start":46,"end":47},{"type":1,"start":65,"end":66},{"type":1,"start":76,"end":77},{"type":1,"start":90,"end":91},{"type":1,"start":101,"end":102},{"type":1,"start":124,"end":125},{"type":1,"start":130,"end":131}]},{"name":"ace7","type":8,"text":"\nprint 't-SNE done! Time elapsed: {} seconds'.format(time.time()-time_start)","markups":[{"type":10,"start":0,"end":76},{"type":1,"start":1,"end":6},{"type":1,"start":45,"end":46},{"type":1,"start":57,"end":58},{"type":1,"start":64,"end":65}]},{"name":"b891","type":8,"text":"[out]\n[t-SNE] Computing pairwise distances...\n[t-SNE] Computed conditional probabilities for sample 1000 / 10000\n[...]\n[t-SNE] Computed conditional probabilities for sample 10000 / 10000\n[t-SNE] Mean sigma: 1.814452\n[t-SNE] Error after 100 iterations with early exaggeration: 18.725542\n[t-SNE] Error after 300 iterations: 2.657761\nt-SNE done! Time elapsed: 1620.80310392 seconds","markups":[]},{"name":"bd29","type":1,"text":"And for the visualisation","markups":[]},{"name":"a0c5","type":8,"text":"df_tsne = None\ndf_tsne = df.loc[rndperm[:n_sne],:].copy()\ndf_tsne['x-tsne-pca'] = tsne_pca_results[:,0]\ndf_tsne['y-tsne-pca'] = tsne_pca_results[:,1]\n\nchart = ggplot( df_tsne, aes(x='x-tsne-pca', y='y-tsne-pca', color='label') ) \\\n        + geom_point(size=70,alpha=0.1) \\\n        + ggtitle(\"tSNE dimensions colored by Digit (PCA)\")\nchart","markups":[{"type":10,"start":0,"end":338},{"type":1,"start":8,"end":9},{"type":1,"start":23,"end":24},{"type":1,"start":27,"end":28},{"type":1,"start":50,"end":51},{"type":1,"start":80,"end":81},{"type":1,"start":126,"end":127},{"type":1,"start":157,"end":158},{"type":1,"start":181,"end":182},{"type":1,"start":197,"end":198},{"type":1,"start":217,"end":218},{"type":1,"start":239,"end":240},{"type":1,"start":256,"end":257},{"type":1,"start":265,"end":266},{"type":1,"start":281,"end":282}]}],"sections":[{"name":"7673","startIndex":0}]},"postDisplay":{"coverless":true}},"virtuals":{"allowNotes":true,"previewImage":{"imageId":"1*aA35Y_xIyqNyeSYqIAifQQ.png","filter":"","backgroundSize":"","originalWidth":1868,"originalHeight":788,"strategy":"resample","height":0,"width":0},"wordCount":2026,"imageCount":4,"readingTime":8.345283018867924,"subtitle":"The first step around any data related challenge is to start by exploring the data itself. This could be by looking at, for example, the…","usersBySocialRecommends":[],"recommends":6,"socialRecommends":[],"isBookmarked":false,"tags":[{"slug":"data-science","name":"Data Science","postCount":10305,"virtuals":{"isFollowing":false},"metadata":{"followerCount":11079,"postCount":10305,"coverImage":{"id":"1*_XW9Jb0dJeQkJRDe7cz0lw.jpeg","originalWidth":2048,"originalHeight":1551,"isFeatured":true}},"type":"Tag"},{"slug":"machine-learning","name":"Machine Learning","postCount":14359,"virtuals":{"isFollowing":false},"metadata":{"followerCount":18241,"postCount":14359,"coverImage":{"id":"1*NuKPenx_agBqFQ3Lrygi8A.jpeg","originalWidth":7360,"originalHeight":4912}},"type":"Tag"},{"slug":"data-visualization","name":"Data Visualization","postCount":5311,"virtuals":{"isFollowing":false},"metadata":{"followerCount":3912,"postCount":5311,"coverImage":{"id":"1*LLAv4-0zllmwMPDEPGC9lA.png","originalWidth":3168,"originalHeight":968,"isFeatured":true}},"type":"Tag"}],"socialRecommendsCount":0,"responsesCreatedCount":0,"links":{"entries":[],"version":"0.3","generatedAt":1477743081172},"isLockedPreviewOnly":false,"takeoverId":"","metaDescription":"","totalClapCount":0},"coverless":true,"slug":"visualising-high-dimensional-datasets-using-pca-and-t-sne-in-python","translationSourcePostId":"","translationSourceCreatorId":"","isApprovedTranslation":false,"inResponseToPostId":"","inResponseToRemovedAt":0,"isTitleSynthesized":true,"allowResponses":true,"importedUrl":"","importedPublishedAt":0,"visibility":0,"uniqueSlug":"visualising-high-dimensional-datasets-using-pca-and-t-sne-in-python-8ef87e7915b","previewContent":{"bodyModel":{"paragraphs":[{"name":"978f","type":3,"text":"Visualising high-dimensional datasets using PCA and t-SNE in Python","markups":[],"alignment":1},{"name":"6a62","type":1,"text":"The first step around any data related challenge is to start by exploring the data itself. This could be by looking at, for example, the distributions of certain variables or looking at potential correlations…","markups":[],"alignment":1}],"sections":[{"startIndex":0}]},"isFullContent":false},"license":0,"inResponseToMediaResourceId":"","canonicalUrl":"https://medium.com/@luckylwk/visualising-high-dimensional-datasets-using-pca-and-t-sne-in-python-8ef87e7915b","approvedHomeCollectionId":"","newsletterId":"","webCanonicalUrl":"https://medium.com/@luckylwk/visualising-high-dimensional-datasets-using-pca-and-t-sne-in-python-8ef87e7915b","mediumUrl":"https://medium.com/@luckylwk/visualising-high-dimensional-datasets-using-pca-and-t-sne-in-python-8ef87e7915b","migrationId":"","notifyFollowers":true,"notifyTwitter":false,"isSponsored":false,"isRequestToPubDisabled":false,"notifyFacebook":false,"responseHiddenOnParentPostAt":0,"isSeries":false,"isSubscriptionLocked":false,"seriesLastAppendedAt":0,"audioVersionDurationSec":0,"sequenceId":"","type":"Post"},"mentionedUsers":[],"collaborators":[],"membershipPlans":[],"collectionUserRelations":[],"mode":null,"references":{"User":{"c85c6404c0f9":{"userId":"c85c6404c0f9","name":"Luuk Derksen","username":"luckylwk","createdAt":1465163139954,"lastPostCreatedAt":1491475524757,"imageId":"0*E-t7oTrRvLnQ3qky.jpeg","backgroundImageId":"","bio":"Data (Scientist) junky. All views my own. | PGP: http://goo.gl/CMdQR7","twitterScreenName":"luckylwk","socialStats":{"userId":"c85c6404c0f9","usersFollowedCount":122,"usersFollowedByCount":55,"type":"SocialStats"},"social":{"userId":"lo_edd7c3f6282a","targetUserId":"c85c6404c0f9","type":"Social"},"facebookAccountId":"","allowNotes":1,"type":"User"}},"Social":{"c85c6404c0f9":{"userId":"lo_edd7c3f6282a","targetUserId":"c85c6404c0f9","type":"Social"}},"SocialStats":{"c85c6404c0f9":{"userId":"c85c6404c0f9","usersFollowedCount":122,"usersFollowedByCount":55,"type":"SocialStats"}}}})
// ]]></script><div class="surface-scrollOverlay"></div><script charset="UTF-8" src="./Visualising high-dimensional datasets using PCA and t-SNE in Python_files/main-common-async.bundle.mISNxGeGc9Ms63X-F7Hi1A.js"></script><script charset="UTF-8" src="./Visualising high-dimensional datasets using PCA and t-SNE in Python_files/main-notes.bundle.ASVjQiM4Xw0FiUDq8p2xTA.js"></script></body></html>